<!DOCTYPE html>
<html  lang="pt-Br">

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Software R: curso avançado</title>
  <meta name="description" content="Curso avançado de análise estatística com R da UFFS Cerro Largo - RS">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Software R: curso avançado" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="http://rstub.github.io/bookdown-chapterbib/" />
  
  <meta property="og:description" content="Curso avançado de análise estatística com R da UFFS Cerro Largo - RS" />
  <meta name="github-repo" content="rstub/bookdown-chapterbib" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Software R: curso avançado" />
  
  <meta name="twitter:description" content="Curso avançado de análise estatística com R da UFFS Cerro Largo - RS" />
  

<meta name="author" content="Felipe Micail da Silva Smolski">
<meta name="author" content="Iara Denise Endruweit Battisti">


<meta name="date" content="2018-08-19">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="analise-fatorial.html">
<link rel="next" href="regressao-logistica.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-112034801-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-112034801-3');
</script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">UFFS - Cerro Largo</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prefácio</a></li>
<li class="chapter" data-level="" data-path="introducao.html"><a href="introducao.html"><i class="fa fa-check"></i>Introdução</a></li>
<li class="chapter" data-level="1" data-path="delineamentos-experimentais.html"><a href="delineamentos-experimentais.html"><i class="fa fa-check"></i><b>1</b> Delineamentos Experimentais</a><ul>
<li class="chapter" data-level="1.1" data-path="delineamentos-experimentais.html"><a href="delineamentos-experimentais.html#principios-basicos-da-experimentacao"><i class="fa fa-check"></i><b>1.1</b> Princípios básicos da Experimentação</a><ul>
<li class="chapter" data-level="1.1.1" data-path="delineamentos-experimentais.html"><a href="delineamentos-experimentais.html#repeticao"><i class="fa fa-check"></i><b>1.1.1</b> Repetição</a></li>
<li class="chapter" data-level="1.1.2" data-path="delineamentos-experimentais.html"><a href="delineamentos-experimentais.html#casualizacao"><i class="fa fa-check"></i><b>1.1.2</b> Casualização</a></li>
<li class="chapter" data-level="1.1.3" data-path="delineamentos-experimentais.html"><a href="delineamentos-experimentais.html#controle-local"><i class="fa fa-check"></i><b>1.1.3</b> Controle local</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="delineamentos-experimentais.html"><a href="delineamentos-experimentais.html#analise-de-variancia"><i class="fa fa-check"></i><b>1.2</b> Análise de Variância</a></li>
<li class="chapter" data-level="1.3" data-path="delineamentos-experimentais.html"><a href="delineamentos-experimentais.html#hipoteses-estatisticas"><i class="fa fa-check"></i><b>1.3</b> Hipóteses estatísticas</a></li>
<li class="chapter" data-level="1.4" data-path="delineamentos-experimentais.html"><a href="delineamentos-experimentais.html#delineamento-inteiramente-causalizado-dic"><i class="fa fa-check"></i><b>1.4</b> Delineamento Inteiramente Causalizado (DIC)</a></li>
<li class="chapter" data-level="1.5" data-path="delineamentos-experimentais.html"><a href="delineamentos-experimentais.html#delineamento-blocos-casualizados-dbc"><i class="fa fa-check"></i><b>1.5</b> Delineamento Blocos Casualizados (DBC)</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="analise-fatorial.html"><a href="analise-fatorial.html"><i class="fa fa-check"></i><b>2</b> Análise Fatorial</a><ul>
<li class="chapter" data-level="2.1" data-path="analise-fatorial.html"><a href="analise-fatorial.html#pressupostos"><i class="fa fa-check"></i><b>2.1</b> Pressupostos</a></li>
<li class="chapter" data-level="2.2" data-path="analise-fatorial.html"><a href="analise-fatorial.html#estatisticas-associadas-a-analise-fatorial"><i class="fa fa-check"></i><b>2.2</b> Estatísticas Associadas a Análise Fatorial</a></li>
<li class="chapter" data-level="2.3" data-path="analise-fatorial.html"><a href="analise-fatorial.html#passos-da-analise-fatorial"><i class="fa fa-check"></i><b>2.3</b> Passos da Análise Fatorial</a><ul>
<li class="chapter" data-level="2.3.1" data-path="analise-fatorial.html"><a href="analise-fatorial.html#construcao-da-matriz-de-correlacao"><i class="fa fa-check"></i><b>2.3.1</b> Construção da Matriz de Correlação</a></li>
<li class="chapter" data-level="2.3.2" data-path="analise-fatorial.html"><a href="analise-fatorial.html#metodo-de-analise-fatorial"><i class="fa fa-check"></i><b>2.3.2</b> Método de Análise Fatorial</a></li>
<li class="chapter" data-level="2.3.3" data-path="analise-fatorial.html"><a href="analise-fatorial.html#determinacao-do-nuumero-de-fatores"><i class="fa fa-check"></i><b>2.3.3</b> Determinação do núumero de fatores</a></li>
<li class="chapter" data-level="2.3.4" data-path="analise-fatorial.html"><a href="analise-fatorial.html#analise-de-componentes-principais"><i class="fa fa-check"></i><b>2.3.4</b> Análise de Componentes Principais</a></li>
<li class="chapter" data-level="2.3.5" data-path="analise-fatorial.html"><a href="analise-fatorial.html#matriz-rotada-do-fator"><i class="fa fa-check"></i><b>2.3.5</b> Matriz Rotada do Fator</a></li>
<li class="chapter" data-level="2.3.6" data-path="analise-fatorial.html"><a href="analise-fatorial.html#autovalores-1"><i class="fa fa-check"></i><b>2.3.6</b> Autovalores</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="regressao-multipla.html"><a href="regressao-multipla.html"><i class="fa fa-check"></i><b>3</b> Regressão Múltipla</a><ul>
<li class="chapter" data-level="3.1" data-path="regressao-multipla.html"><a href="regressao-multipla.html#modelo-geral"><i class="fa fa-check"></i><b>3.1</b> Modelo geral</a></li>
<li class="chapter" data-level="3.2" data-path="regressao-multipla.html"><a href="regressao-multipla.html#variavel-dummy"><i class="fa fa-check"></i><b>3.2</b> Variável dummy</a></li>
<li class="chapter" data-level="3.3" data-path="regressao-multipla.html"><a href="regressao-multipla.html#metodos-selecao-de-variaveis-na-regressao-multipla"><i class="fa fa-check"></i><b>3.3</b> Métodos seleção de variáveis na regressão múltipla</a><ul>
<li class="chapter" data-level="3.3.1" data-path="regressao-multipla.html"><a href="regressao-multipla.html#full-model-modelo-completo"><i class="fa fa-check"></i><b>3.3.1</b> Full model – Modelo completo</a></li>
<li class="chapter" data-level="3.3.2" data-path="regressao-multipla.html"><a href="regressao-multipla.html#procedimento-backward"><i class="fa fa-check"></i><b>3.3.2</b> Procedimento backward</a></li>
<li class="chapter" data-level="3.3.3" data-path="regressao-multipla.html"><a href="regressao-multipla.html#procedimento-forward"><i class="fa fa-check"></i><b>3.3.3</b> Procedimento forward</a></li>
<li class="chapter" data-level="3.3.4" data-path="regressao-multipla.html"><a href="regressao-multipla.html#procedimento-stepwise"><i class="fa fa-check"></i><b>3.3.4</b> Procedimento stepwise</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="regressao-logistica.html"><a href="regressao-logistica.html"><i class="fa fa-check"></i><b>4</b> Regressão Logística</a><ul>
<li class="chapter" data-level="4.1" data-path="regressao-logistica.html"><a href="regressao-logistica.html#o-modelo"><i class="fa fa-check"></i><b>4.1</b> O modelo</a></li>
<li class="chapter" data-level="4.2" data-path="regressao-logistica.html"><a href="regressao-logistica.html#regressao-logistica-simples"><i class="fa fa-check"></i><b>4.2</b> Regressão Logística Simples</a><ul>
<li class="chapter" data-level="4.2.1" data-path="regressao-logistica.html"><a href="regressao-logistica.html#estimando-a-razao-de-chances"><i class="fa fa-check"></i><b>4.2.1</b> Estimando a Razão de Chances</a></li>
<li class="chapter" data-level="4.2.2" data-path="regressao-logistica.html"><a href="regressao-logistica.html#determinando-o-intervalo-de-confianca"><i class="fa fa-check"></i><b>4.2.2</b> Determinando o Intervalo de Confiança</a></li>
<li class="chapter" data-level="4.2.3" data-path="regressao-logistica.html"><a href="regressao-logistica.html#predicao-de-probabilidades"><i class="fa fa-check"></i><b>4.2.3</b> Predição de Probabilidades</a></li>
<li class="chapter" data-level="4.2.4" data-path="regressao-logistica.html"><a href="regressao-logistica.html#matriz-de-confusao"><i class="fa fa-check"></i><b>4.2.4</b> Matriz de Confusão</a></li>
<li class="chapter" data-level="4.2.5" data-path="regressao-logistica.html"><a href="regressao-logistica.html#curva-roc"><i class="fa fa-check"></i><b>4.2.5</b> Curva ROC</a></li>
<li class="chapter" data-level="4.2.6" data-path="regressao-logistica.html"><a href="regressao-logistica.html#o-teste-hosmer-e-lemeshow"><i class="fa fa-check"></i><b>4.2.6</b> O teste Hosmer e Lemeshow</a></li>
<li class="chapter" data-level="4.2.7" data-path="regressao-logistica.html"><a href="regressao-logistica.html#pseudo-r2"><i class="fa fa-check"></i><b>4.2.7</b> Pseudo R<span class="math inline">\(^2\)</span></a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="regressao-logistica.html"><a href="regressao-logistica.html#regressao-logistica-multipla"><i class="fa fa-check"></i><b>4.3</b> Regressão Logística Múltipla</a><ul>
<li class="chapter" data-level="4.3.1" data-path="regressao-logistica.html"><a href="regressao-logistica.html#metodo-stepwise"><i class="fa fa-check"></i><b>4.3.1</b> Método Stepwise</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="regressao-logistica.html"><a href="regressao-logistica.html#regressao-logistica-multipla-com-variavel-categorica"><i class="fa fa-check"></i><b>4.4</b> Regressão Logística Múltipla com variável categórica</a></li>
<li class="chapter" data-level="4.5" data-path="regressao-logistica.html"><a href="regressao-logistica.html#exemplos-de-trabalhos-que-utilizaram-regressao-logistica"><i class="fa fa-check"></i><b>4.5</b> Exemplos de trabalhos que utilizaram regressão logística</a></li>
<li class="chapter" data-level="4.6" data-path="regressao-logistica.html"><a href="regressao-logistica.html#exercicios"><i class="fa fa-check"></i><b>4.6</b> Exercícios</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="referencias.html"><a href="referencias.html"><i class="fa fa-check"></i>Referências</a></li>
<li class="divider"></li>
<li><a href="https://smolski.github.io/softwarelivrer/" target="blank">Curso de Extensão</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Software R: curso avançado</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="regressao-multipla" class="section level1">
<h1><span class="header-section-number">Capítulo 3</span> Regressão Múltipla</h1>
<div id="modelo-geral" class="section level2">
<h2><span class="header-section-number">3.1</span> Modelo geral</h2>
<p>Um modelo de regressão múltipla é expresso como:</p>
<p><span class="math display">\[ 
y_{i} = \beta_0+\ \beta_1x_{1i}+\beta_2x_{2i}+\dots+\beta_kx_{ki}+\varepsilon_i\ 
\]</span>

em que:</p>
<ul>
<li><p><span class="math inline">\(y_{i}\)</span>: valores da variável resposta, <span class="math inline">\(i = 1, 2,..., n\)</span> observações;</p></li>
<li><p><span class="math inline">\(x\)</span>: valores das variáveis explicativas, <span class="math inline">\(k = 1, 2,..., K\)</span> variáveis;</p></li>
<li><p><span class="math inline">\(\beta_k\)</span>: parâmetros do modelo;</p></li>
<li><p><span class="math inline">\(\varepsilon_i\)</span>: erro aleatório.</p></li>
</ul>
<p>A equação estimada para este modelo é definida como:</p>
<p><span class="math display">\[ 
y_{i} = b_0+\ b_1x_{1i}+b_2x_{2i}+\dots+b_kx_{ki} 
\]</span>
em que:</p>
<ul>
<li><span class="math inline">\(b_k\)</span>: coeficientes estimados.</li>
</ul>
</div>
<div id="variavel-dummy" class="section level2">
<h2><span class="header-section-number">3.2</span> Variável dummy</h2>
<p>Em algumas situações é necessário introduzir, como variável preditora (independente), uma variável categórica no
modelo de regressão linear simples ou múltiplo, como por exemplo, local (urbano ou rural), área (preservada ou degradada), etc, podendo ter mais que duas categorias. Essa variável terá que ser codificada, utilizando somente códigos 0 e 1, assim chamada variável dummy.</p>
<p>O número de variáveis dummy no modelo será sempre igual ao número de categorias da variável preditora original
menos 1. Por exemplo:</p>
<ul>
<li><p>Para a variável preditora “local” que assume valores - urbano ou rural, então têm-se a variável dummy
local_dummy assumindo 0 para rural e 1 para urbano; também, poderia ser utilizado 1 para rural e 0 para
urbano. Uma indicação é que a categoria que assume o valor 0 seja a categoria de referência.</p></li>
<li><p>Para a variável preditora “grau de escolaridade”&quot; que assume valores – ensino fundamental, ensino médio,
ensino superior, então têm-se as variáveis dummy: escola1 e escola2, assim definido:</p></li>
</ul>
<ol style="list-style-type: lower-alpha">
<li>escola1=0 e escola2=0 para ensino fundamental;</li>
<li>escola1=1 e escola2=0 para ensino médio;</li>
<li>escola1=0 e escola2=1 para ensino superior.</li>
</ol>
<p><strong>Exercício</strong>:</p>
<ol style="list-style-type: decimal">
<li>Utilizando o banco de dados <code>ARVORE2</code>, ajuste um modelo de regressão linear simples para predizer a altura das árvores
em função do diâmetro. Veja essa relação no diagrama de dispersão. Interprete os resultados.</li>
</ol>
<p>Relembrando Modelos de Regressão Linear Simples – Curso Básico do Software R:</p>
<ul>
<li>1.1 Ajustar a equação de regressão. Interpretá-la.</li>
<li>1.2 Encontrar e interpretar a significância da equação.</li>
<li>1.3 Encontrar e interpretar o coeficiente de determinação.</li>
<li>1.4 Analisar graficamente os resíduos.</li>
<li>1.5 Testar a normalidade dos resíduos.</li>
</ul>
<p>Adicionalmente - Curso Avançado do Software R:</p>
<ul>
<li>1.6 Analisar pontos <em>outliers</em> nos resíduos.</li>
</ul>
<p>Para análise dos valores <em>outliers</em> nos resíduos (<em>residuals standard</em> e <em>residuals studentized</em>), utilizam-se os seguintes comandos:</p>
<p><code>rstudent(regressao)</code></p>
<p><code>rstandard(regressao)</code></p>
<p>E o gráfico para verificar valores outliers nos resíduos:</p>
<p><code>plot(rstudent(regressao))</code></p>
<p><code>plot(rstandard(regressao))</code></p>
<p>Aqueles valores maiores que |2| são possíveis outliers. Incluir uma linha y =2 e y=-2, para facilitar a visualização de outliers.</p>
<ul>
<li>1.7 Analisar pontos influentes nos resíduos.</li>
</ul>
<p>Para análise dos valores influentes, utiliza-se:</p>
<p><code>dffits(regressao)</code></p>
<p>Aqueles valores maiores que <code>2*(p/n)^(1/2)</code> são possíveis pontos influentes. Em que, p = número de parâmetros do modelo e n = tamanho da amostra. O gráfico para detectar pontos influentes pode ser elaborado pelo comando:</p>
<p><code>plot(dffits(regressao))</code></p>
<p>Aqueles valores maiores, em módulo, são possíveis influentes. Incluir linhas para facilitar a visualização de pontos influentes.</p>
<p>Ainda, pode-se utilizar o comando <code>plot(regressao)</code> elabora diferentes gráficos para o diagnóstico do modelo.</p>
<ol start="2" style="list-style-type: decimal">
<li><p>Ajuste um segundo modelo de regressão linear simples para predizer a altura das árvores em função da espécie. Veja essa relação no diagrama de dispersão. Interprete os resultados.</p></li>
<li><p>Ajuste um terceiro modelo de regressão múltipla para predizer a altura das árvores em função do diâmetro e da espécie. Interprete os resultados.</p></li>
</ol>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" data-line-number="1"><span class="kw">library</span>(readxl)</a>
<a class="sourceLine" id="cb64-2" data-line-number="2">url &lt;-<span class="st"> &quot;https://github.com/Smolski/softwarelivrer/raw/master/avancado/arvore2.xlsx&quot;</span></a>
<a class="sourceLine" id="cb64-3" data-line-number="3">destfile &lt;-<span class="st"> &quot;arvore2.xlsx&quot;</span></a>
<a class="sourceLine" id="cb64-4" data-line-number="4">curl<span class="op">::</span><span class="kw">curl_download</span>(url, destfile)</a>
<a class="sourceLine" id="cb64-5" data-line-number="5">arvore2 &lt;-<span class="st"> </span><span class="kw">read_excel</span>(destfile)</a>
<a class="sourceLine" id="cb64-6" data-line-number="6"><span class="kw">attach</span>(arvore2)</a>
<a class="sourceLine" id="cb64-7" data-line-number="7"><span class="kw">head</span>(arvore2)</a></code></pre></div>
<pre><code># A tibble: 6 x 4
  Nomecientifico            diametro_cm altura_m especie
  &lt;chr&gt;                           &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;
1 Sebastiania commersoniana        52.2     15.2       0
2 Sebastiania commersoniana        95       17.3       0
3 Sebastiania commersoniana        67.3     16.3       0
4 Sebastiania commersoniana        46.3     14         0
5 Sebastiania commersoniana        64.1     15         0
6 Sebastiania commersoniana       122       22         0</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" data-line-number="1">modelom=<span class="kw">lm</span>(altura_m<span class="op">~</span>diametro_cm<span class="op">+</span>especie) </a>
<a class="sourceLine" id="cb66-2" data-line-number="2">modelom</a></code></pre></div>
<pre><code>
Call:
lm(formula = altura_m ~ diametro_cm + especie)

Coefficients:
(Intercept)  diametro_cm      especie  
    12.6959       0.0571      -1.6252  </code></pre>
<p>Modelo:
<span class="math display">\[
Y = 12,328 + 0,0576 x_1 – 1,423 x_2
\]</span>
Ou</p>
<p><span class="math display">\[
\text{Altura} = 12,328 + 0,0576\text{diâmetro} – 1,423\text{espécie}
\]</span></p>
<p>Verificando a significância de cada coeficiente do modelo de regressão múltipla:</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb68-1" data-line-number="1"><span class="kw">summary</span>(modelom)</a></code></pre></div>
<pre><code>
Call:
lm(formula = altura_m ~ diametro_cm + especie)

Residuals:
   Min     1Q Median     3Q    Max 
-3.269 -0.766 -0.124  0.813  2.873 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 12.69592    0.38639   32.86  &lt; 2e-16 ***
diametro_cm  0.05713    0.00445   12.84  &lt; 2e-16 ***
especie     -1.62517    0.24459   -6.64  1.5e-09 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 1.19 on 102 degrees of freedom
Multiple R-squared:   0.7,  Adjusted R-squared:  0.694 
F-statistic:  119 on 2 and 102 DF,  p-value: &lt;2e-16</code></pre>
<p>Verificar a significância do modelo completo.</p>
<p>Verificar o coeficiente de determinação do modelo.</p>
<p>Realizar análise dos resíduos.</p>
<ul>
<li>gráfico dos resíduos com cada variável preditora</li>
<li>resíduos padronizados para verificar outlier</li>
<li>verificar pontos infuentes</li>
</ul>
<p>A interpretação dos termos de regressão é um pouco mais complicada. Em geral, um modelo com múltiplos preditores indica a diferença média na variável desfecho quando mudamos o valor de uma variável e mantemos a outra constante.</p>
<p>Nesse caso, entre árvores de mesmo diâmetro (<span class="math inline">\(x_1\)</span>), a diferença média esperada da altura (y) para a espécie <em>Syphoneugena reitzii</em> em relação a espécie <em>Sebastiania</em> commersoniana é de cerca de 1,42m a menos (pois <span class="math inline">\(b_3\)</span>=-1,42).</p>
<p>Da mesma forma, árvores da mesma espécie têm, em média, 0,05758m (pois <span class="math inline">\(b_2\)</span>=0,05758) a mais a cada 1 cm de diâmetro.</p>
<p>Como envolvem mais variáveis, não é possível resolver o modelo inteiro num único gráfico. Como alternativa, pode-se plotar a reta para cada espécie (variável categórica).</p>
<p>Primeiro, os pontos são plotados. O argumento <code>type='n'</code> indica que não é para acrescentar nenhum ponto ao gráfico.
Em seguida, os pontos são acrescentados separadamente, com a função points, a qual acrescenta pontos ao gráfico, sendo que o colchetes <code>[espécie==0]</code> seleciona somente os casos desejados.</p>
<p>Por fim, acrescentamos as retas de regressão para cada resposta a variável independente espécie. Usamos a função <code>coef</code> para extrair os coeficientes de interesse.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" data-line-number="1"><span class="kw">plot</span>(diametro_cm,altura_m)</a>
<a class="sourceLine" id="cb70-2" data-line-number="2"><span class="co"># Gera o gráfico sem pontos</span></a>
<a class="sourceLine" id="cb70-3" data-line-number="3"><span class="kw">plot</span>(diametro_cm,altura_m,<span class="dt">type=</span><span class="st">&#39;n&#39;</span>) </a>
<a class="sourceLine" id="cb70-4" data-line-number="4"><span class="co"># Acrescenta os pontos</span></a>
<a class="sourceLine" id="cb70-5" data-line-number="5"><span class="kw">points</span>(diametro_cm[especie<span class="op">==</span><span class="dv">0</span>],altura_m[especie<span class="op">==</span><span class="dv">0</span>],<span class="dt">col=</span><span class="st">&#39;blue&#39;</span>)</a>
<a class="sourceLine" id="cb70-6" data-line-number="6"><span class="kw">points</span>(diametro_cm[especie<span class="op">==</span><span class="dv">1</span>],altura_m[especie<span class="op">==</span><span class="dv">1</span>],<span class="dt">col=</span><span class="st">&#39;red&#39;</span>)</a>
<a class="sourceLine" id="cb70-7" data-line-number="7"><span class="co"># Acrescenta as linhas</span></a>
<a class="sourceLine" id="cb70-8" data-line-number="8"><span class="kw">abline</span>(<span class="kw">coef</span>(modelom)[<span class="dv">1</span>], <span class="kw">coef</span>(modelom)[<span class="dv">2</span>], <span class="dt">col=</span><span class="st">&#39;blue&#39;</span>)</a>
<a class="sourceLine" id="cb70-9" data-line-number="9"><span class="kw">abline</span>(<span class="kw">coef</span>(modelom)[<span class="dv">1</span>]<span class="op">+</span><span class="kw">coef</span>(modelom)[<span class="dv">3</span>], <span class="kw">coef</span>(modelom)[<span class="dv">2</span>], <span class="dt">col=</span><span class="st">&#39;red&#39;</span>)</a></code></pre></div>
<p><img src="04-RegMult_files/figure-html/unnamed-chunk-5-1.png" width="60%" style="display: block; margin: auto;" /></p>
</div>
<div id="metodos-selecao-de-variaveis-na-regressao-multipla" class="section level2">
<h2><span class="header-section-number">3.3</span> Métodos seleção de variáveis na regressão múltipla</h2>
<div id="full-model-modelo-completo" class="section level3">
<h3><span class="header-section-number">3.3.1</span> Full model – Modelo completo</h3>
<p>Sintaxe no software R para um modelo de regressão múltipla com três variáveis preditivas:</p>
<p><code>regressao=lm(y~x1+x2+x3)</code></p>
<p><code>summary(regressao)</code></p>
<p>Existem três métodos de seleção de variáveis para modelos de regressão múltipla: <em>backward</em>, <em>forward</em> e <em>stepwise</em>.</p>
<p><code>regressao=step(lm(y~x1+x2+x3),direction = 'método')</code></p>
</div>
<div id="procedimento-backward" class="section level3">
<h3><span class="header-section-number">3.3.2</span> Procedimento backward</h3>
<p>Considera todas as variáveis inicialmente, testando posteriormente, a permanência de cada uma no modelo. Se p <span class="math inline">\(\leq\)</span> 15%, permanece no modelo (saiu do modelo não entra mais) (Riboldi, 2005).</p>
<p>Passo 1) Ajustar o modelo completo de m variáveis e obter <span class="math inline">\(SQR^{c}_{eg}\)</span> e <span class="math inline">\(\sigma^{2}\)</span>;</p>
<p>Passo 2) Para cada uma das m variáveis do modelo completo do passo 1, considerar o modelo reduzido – retirando esta variável
– e calcular <span class="math inline">\(SQR^{r}_{eg}\)</span> para obter o valor da estatística (slide 24);</p>
<p>Passo 3) Achar o mínimo dos m valores da estatística obtidos no passo 2, denotado por F<sub>min</sub>;</p>
<p>Passo 4) Seja F<sub>out</sub> o valor da distribuição F com 1 e (n-m-1) gl;</p>
<ul>
<li><p>Se F<sub>min</sub> &gt; F<sub>out</sub>: interromper o processo e optar pelo modelo completo desta etapa;</p></li>
<li><p>Se F<sub>min</sub> &lt; F<sub>out</sub>: voltar ao passo 1, iniciando nova etapa em que o modelo completo tem (m-1) variáveis – dada a
eliminação da variável cuja estatística é igual a F<sub>min</sub>.</p></li>
</ul>
</div>
<div id="procedimento-forward" class="section level3">
<h3><span class="header-section-number">3.3.3</span> Procedimento forward</h3>
<p>Inclui uma variável de cada vez, se p <span class="math inline">\(\leq\)</span> 20%, entra no modelo. Este método não testa a permanência da variável (entrou no
modelo não sai mais) (Riboldi, 2005).</p>
<p>Passo 1) Ajustar o modelo reduzido de m variáveis e obter <span class="math inline">\(SQR^{c}_{eg}\)</span>;</p>
<p>Passo 2) Para cada variável não pertencente ao modelo do passo 1, considerar o modelo completo com adição desta variável
extra e calcular <span class="math inline">\(SQR^{r}_{eg}\)</span> e <span class="math inline">\(\sigma^{2}\)</span> para obter o valor da estatística (slide 26);</p>
<p>Passo 3) Achar o máximo dos valores da estatística obtidos no passo 2, denotado por F<sub>max</sub>;</p>
<p>Passo 4) Seja F<sub>in</sub> o valor da distribuição F com 1 e (n-m) gl;</p>
<ul>
<li><p>Se F<sub>max</sub> &gt; F<sub>in</sub>: voltar ao passo 1, iniciando nova etapa em que o modelo reduzido tem (m+1) variáveis – dada a inclusão
da variável cuja estatística é igual a F<sub>max</sub>.</p></li>
<li><p>Se F<sub>max</sub> &lt; F<sub>in</sub>: interromper o processo e optar pelo modelo reduzido desta etapa;</p></li>
</ul>
</div>
<div id="procedimento-stepwise" class="section level3">
<h3><span class="header-section-number">3.3.4</span> Procedimento stepwise</h3>
<p>Inclui as variáveis passo-a-passo e testa a permanência (as variáveis podem entrar e sair do modelo) (Riboldi, 2005).</p>
<p>Passo 1) Ajustar o modelo reduzido de m variáveis e obter <span class="math inline">\(SQR^{r}_{eg}\)</span>;</p>
<p>Passo 2) Para cada variável não pertencente ao modelo do passo 1, considerar o modelo completo - com adição desta variável
extra - e calcular <span class="math inline">\(SQR^{c}_{eg}\)</span> e <span class="math inline">\(\sigma^{2}\)</span> para obter o valor da estatística (slide 26);</p>
<p>Passo 3) Achar o máximo dos valores da estatística obtidos no passo 2, denotado por F<sub>max</sub>;</p>
<p>Passo 4) Seja Fin o valor da distribuição F com 1 e (n-m) gl;</p>
<ul>
<li><p>Se Fmax &gt; Fin -&gt; passar ao passo 5, com modelo completo composto por (m+1) variáveis – as m variáveis do modelo do
passo 1 e a variável cuja estatística é igual a Fmax.</p></li>
<li><p>Se Fmax &lt; Fin -&gt; passar ao passo 5, com modelo completo igual ao modelo do passo 1 ou encerrar o processo se no passo
8 da etapa anterior, nenhuma variável tiver sido eliminada;</p></li>
</ul>
<p>Passo 5) Ajustar o modelo completo de k variáveis – sendo k igual a m ou (m+1), e obter <span class="math inline">\(SQR^{c}_{eg}\)</span> e <span class="math inline">\(\sigma^{2}\)</span>;</p>
<p>Passo 6) Para cada uma das k variáveis do modelo completo do passo 5, considerar o modelo reduzido – retirando esta variável – e calcular <span class="math inline">\(SQR^{r}_{eg}\)</span> para obter o valor da estatística;</p>
<p>Passo 7) Achar o mínimo dos k valores da estatística obtidos no passo 6, denotado por F<sub>min</sub>;</p>
<p>Passo 8) Seja F<sub>out</sub> o valor da distribuição F com 1 e (n-k-1) gl;</p>
<ul>
<li><p>Se F<sub>min</sub> &gt; F<sub>out</sub>: não eliminar nenhuma variável e voltar ao passo 1, iniciando nova etapa com modelo reduzido com k
variáveis ou encerrar o processo de no passo 4 nenhuma variável tiver sido anexada;</p></li>
<li><p>Se Fmin &lt; Fout: eliminar a variável cuja estatística é igual a Fmin e voltar ao passo 1 iniciando nova etapa com modelo
reduzido com (k-1) variáveis.</p></li>
</ul>
<div class="figure">
<img src="regress1.png" alt="Modelagem estatística" />
<p class="caption">Modelagem estatística</p>
</div>
<!--
\printbibliography[segment=\therefsegment,heading=subbibliography]
-->

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="analise-fatorial.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="regressao-logistica.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": ["livroavancado.pdf", "livroavancado.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
