<!DOCTYPE html>
<html  lang="pt-Br">

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Software R: curso avançado</title>
  <meta name="description" content="Curso avançado de análise estatística com R da UFFS Cerro Largo - RS">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Software R: curso avançado" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="http://rstub.github.io/bookdown-chapterbib/" />
  
  <meta property="og:description" content="Curso avançado de análise estatística com R da UFFS Cerro Largo - RS" />
  <meta name="github-repo" content="rstub/bookdown-chapterbib" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Software R: curso avançado" />
  
  <meta name="twitter:description" content="Curso avançado de análise estatística com R da UFFS Cerro Largo - RS" />
  

<meta name="author" content="Felipe Micail da Silva Smolski">
<meta name="author" content="Iara Denise Endruweit Battisti">


<meta name="date" content="2018-10-25">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="regressao-com-dados-em-painel.html">
<link rel="next" href="regressao-de-poisson.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-112034801-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-112034801-3');
</script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">UFFS - Cerro Largo</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prefácio</a></li>
<li class="chapter" data-level="" data-path="introducao.html"><a href="introducao.html"><i class="fa fa-check"></i>Introdução</a></li>
<li class="chapter" data-level="1" data-path="delineamentos-experimentais.html"><a href="delineamentos-experimentais.html"><i class="fa fa-check"></i><b>1</b> Delineamentos Experimentais</a><ul>
<li class="chapter" data-level="1.1" data-path="delineamentos-experimentais.html"><a href="delineamentos-experimentais.html#principios-basicos-da-experimentacao"><i class="fa fa-check"></i><b>1.1</b> Princípios básicos da Experimentação</a><ul>
<li class="chapter" data-level="1.1.1" data-path="delineamentos-experimentais.html"><a href="delineamentos-experimentais.html#repeticao"><i class="fa fa-check"></i><b>1.1.1</b> Repetição</a></li>
<li class="chapter" data-level="1.1.2" data-path="delineamentos-experimentais.html"><a href="delineamentos-experimentais.html#casualizacao"><i class="fa fa-check"></i><b>1.1.2</b> Casualização</a></li>
<li class="chapter" data-level="1.1.3" data-path="delineamentos-experimentais.html"><a href="delineamentos-experimentais.html#controle-local"><i class="fa fa-check"></i><b>1.1.3</b> Controle local</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="delineamentos-experimentais.html"><a href="delineamentos-experimentais.html#analise-de-variancia"><i class="fa fa-check"></i><b>1.2</b> Análise de Variância</a></li>
<li class="chapter" data-level="1.3" data-path="delineamentos-experimentais.html"><a href="delineamentos-experimentais.html#hipoteses-estatisticas"><i class="fa fa-check"></i><b>1.3</b> Hipóteses estatísticas</a></li>
<li class="chapter" data-level="1.4" data-path="delineamentos-experimentais.html"><a href="delineamentos-experimentais.html#delineamento-inteiramente-causalizado-dic"><i class="fa fa-check"></i><b>1.4</b> Delineamento Inteiramente Causalizado (DIC)</a></li>
<li class="chapter" data-level="1.5" data-path="delineamentos-experimentais.html"><a href="delineamentos-experimentais.html#delineamento-blocos-casualizados-dbc"><i class="fa fa-check"></i><b>1.5</b> Delineamento Blocos Casualizados (DBC)</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="analise-fatorial.html"><a href="analise-fatorial.html"><i class="fa fa-check"></i><b>2</b> Análise Fatorial</a><ul>
<li class="chapter" data-level="2.1" data-path="analise-fatorial.html"><a href="analise-fatorial.html#pressupostos"><i class="fa fa-check"></i><b>2.1</b> Pressupostos</a></li>
<li class="chapter" data-level="2.2" data-path="analise-fatorial.html"><a href="analise-fatorial.html#estatisticas-associadas-a-analise-fatorial"><i class="fa fa-check"></i><b>2.2</b> Estatísticas Associadas a Análise Fatorial</a></li>
<li class="chapter" data-level="2.3" data-path="analise-fatorial.html"><a href="analise-fatorial.html#passos-da-analise-fatorial"><i class="fa fa-check"></i><b>2.3</b> Passos da Análise Fatorial</a><ul>
<li class="chapter" data-level="2.3.1" data-path="analise-fatorial.html"><a href="analise-fatorial.html#construcao-da-matriz-de-correlacao"><i class="fa fa-check"></i><b>2.3.1</b> Construção da Matriz de Correlação</a></li>
<li class="chapter" data-level="2.3.2" data-path="analise-fatorial.html"><a href="analise-fatorial.html#metodo-de-analise-fatorial"><i class="fa fa-check"></i><b>2.3.2</b> Método de Análise Fatorial</a></li>
<li class="chapter" data-level="2.3.3" data-path="analise-fatorial.html"><a href="analise-fatorial.html#determinacao-do-nuumero-de-fatores"><i class="fa fa-check"></i><b>2.3.3</b> Determinação do núumero de fatores</a></li>
<li class="chapter" data-level="2.3.4" data-path="analise-fatorial.html"><a href="analise-fatorial.html#analise-de-componentes-principais"><i class="fa fa-check"></i><b>2.3.4</b> Análise de Componentes Principais</a></li>
<li class="chapter" data-level="2.3.5" data-path="analise-fatorial.html"><a href="analise-fatorial.html#matriz-rotada-do-fator"><i class="fa fa-check"></i><b>2.3.5</b> Matriz Rotada do Fator</a></li>
<li class="chapter" data-level="2.3.6" data-path="analise-fatorial.html"><a href="analise-fatorial.html#autovalores-1"><i class="fa fa-check"></i><b>2.3.6</b> Autovalores</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="regressao-multipla.html"><a href="regressao-multipla.html"><i class="fa fa-check"></i><b>3</b> Regressão Múltipla</a><ul>
<li class="chapter" data-level="3.1" data-path="regressao-multipla.html"><a href="regressao-multipla.html#modelo-geral"><i class="fa fa-check"></i><b>3.1</b> Modelo geral</a></li>
<li class="chapter" data-level="3.2" data-path="regressao-multipla.html"><a href="regressao-multipla.html#variavel-dummy"><i class="fa fa-check"></i><b>3.2</b> Variável dummy</a></li>
<li class="chapter" data-level="3.3" data-path="regressao-multipla.html"><a href="regressao-multipla.html#interacao-entre-variaveis-preditoras"><i class="fa fa-check"></i><b>3.3</b> Interação entre variáveis preditoras</a></li>
<li class="chapter" data-level="3.4" data-path="regressao-multipla.html"><a href="regressao-multipla.html#metodos-selecao-de-variaveis-na-regressao-multipla"><i class="fa fa-check"></i><b>3.4</b> Métodos seleção de variáveis na regressão múltipla</a><ul>
<li class="chapter" data-level="3.4.1" data-path="regressao-multipla.html"><a href="regressao-multipla.html#full-model-modelo-completo"><i class="fa fa-check"></i><b>3.4.1</b> Full model – Modelo completo</a></li>
<li class="chapter" data-level="3.4.2" data-path="regressao-multipla.html"><a href="regressao-multipla.html#procedimento-backward"><i class="fa fa-check"></i><b>3.4.2</b> Procedimento backward</a></li>
<li class="chapter" data-level="3.4.3" data-path="regressao-multipla.html"><a href="regressao-multipla.html#procedimento-forward"><i class="fa fa-check"></i><b>3.4.3</b> Procedimento forward</a></li>
<li class="chapter" data-level="3.4.4" data-path="regressao-multipla.html"><a href="regressao-multipla.html#procedimento-stepwise"><i class="fa fa-check"></i><b>3.4.4</b> Procedimento stepwise</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="regressao-multipla.html"><a href="regressao-multipla.html#roteiro-para-o-diagnostico-do-modelo-de-regressao-multipla-ajustado"><i class="fa fa-check"></i><b>3.5</b> Roteiro para o diagnóstico do modelo de regressão múltipla ajustado</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="regressao-com-dados-em-painel.html"><a href="regressao-com-dados-em-painel.html"><i class="fa fa-check"></i><b>4</b> Regressão com Dados em Painel</a><ul>
<li class="chapter" data-level="4.1" data-path="regressao-com-dados-em-painel.html"><a href="regressao-com-dados-em-painel.html#carregamento-e-transformacao-dos-dados"><i class="fa fa-check"></i><b>4.1</b> Carregamento e transformação dos dados</a></li>
<li class="chapter" data-level="4.2" data-path="regressao-com-dados-em-painel.html"><a href="regressao-com-dados-em-painel.html#modelo-pooled"><i class="fa fa-check"></i><b>4.2</b> Modelo Pooled</a></li>
<li class="chapter" data-level="4.3" data-path="regressao-com-dados-em-painel.html"><a href="regressao-com-dados-em-painel.html#modelo-efeitos-fixos"><i class="fa fa-check"></i><b>4.3</b> Modelo Efeitos Fixos</a></li>
<li class="chapter" data-level="4.4" data-path="regressao-com-dados-em-painel.html"><a href="regressao-com-dados-em-painel.html#modelo-efeitos-aleatorios"><i class="fa fa-check"></i><b>4.4</b> Modelo Efeitos Aleatórios</a></li>
<li class="chapter" data-level="4.5" data-path="regressao-com-dados-em-painel.html"><a href="regressao-com-dados-em-painel.html#comparacao-e-escolha-dos-modelos"><i class="fa fa-check"></i><b>4.5</b> Comparação e escolha dos modelos</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="regressao-logistica.html"><a href="regressao-logistica.html"><i class="fa fa-check"></i><b>5</b> Regressão Logística</a><ul>
<li class="chapter" data-level="5.1" data-path="regressao-logistica.html"><a href="regressao-logistica.html#o-modelo"><i class="fa fa-check"></i><b>5.1</b> O modelo</a></li>
<li class="chapter" data-level="5.2" data-path="regressao-logistica.html"><a href="regressao-logistica.html#regressao-logistica-simples"><i class="fa fa-check"></i><b>5.2</b> Regressão Logística Simples</a><ul>
<li class="chapter" data-level="5.2.1" data-path="regressao-logistica.html"><a href="regressao-logistica.html#estimando-a-razao-de-chances"><i class="fa fa-check"></i><b>5.2.1</b> Estimando a Razão de Chances</a></li>
<li class="chapter" data-level="5.2.2" data-path="regressao-logistica.html"><a href="regressao-logistica.html#determinando-o-intervalo-de-confianca"><i class="fa fa-check"></i><b>5.2.2</b> Determinando o Intervalo de Confiança</a></li>
<li class="chapter" data-level="5.2.3" data-path="regressao-logistica.html"><a href="regressao-logistica.html#predicao-de-probabilidades"><i class="fa fa-check"></i><b>5.2.3</b> Predição de Probabilidades</a></li>
<li class="chapter" data-level="5.2.4" data-path="regressao-logistica.html"><a href="regressao-logistica.html#matriz-de-confusao"><i class="fa fa-check"></i><b>5.2.4</b> Matriz de Confusão</a></li>
<li class="chapter" data-level="5.2.5" data-path="regressao-logistica.html"><a href="regressao-logistica.html#curva-roc"><i class="fa fa-check"></i><b>5.2.5</b> Curva ROC</a></li>
<li class="chapter" data-level="5.2.6" data-path="regressao-logistica.html"><a href="regressao-logistica.html#o-teste-hosmer-e-lemeshow"><i class="fa fa-check"></i><b>5.2.6</b> O teste Hosmer e Lemeshow</a></li>
<li class="chapter" data-level="5.2.7" data-path="regressao-logistica.html"><a href="regressao-logistica.html#pseudo-r2"><i class="fa fa-check"></i><b>5.2.7</b> Pseudo R<span class="math inline">\(^2\)</span></a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="regressao-logistica.html"><a href="regressao-logistica.html#regressao-logistica-multipla"><i class="fa fa-check"></i><b>5.3</b> Regressão Logística Múltipla</a><ul>
<li class="chapter" data-level="5.3.1" data-path="regressao-logistica.html"><a href="regressao-logistica.html#metodo-stepwise"><i class="fa fa-check"></i><b>5.3.1</b> Método Stepwise</a></li>
<li class="chapter" data-level="5.3.2" data-path="regressao-logistica.html"><a href="regressao-logistica.html#vif---variance-inflation-factor"><i class="fa fa-check"></i><b>5.3.2</b> VIF - Variance Inflation Factor</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="regressao-logistica.html"><a href="regressao-logistica.html#regressao-logistica-multipla-com-variavel-categorica"><i class="fa fa-check"></i><b>5.4</b> Regressão Logística Múltipla com variável categórica</a></li>
<li class="chapter" data-level="5.5" data-path="regressao-logistica.html"><a href="regressao-logistica.html#exercicios"><i class="fa fa-check"></i><b>5.5</b> Exercícios</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="regressao-de-poisson.html"><a href="regressao-de-poisson.html"><i class="fa fa-check"></i><b>6</b> Regressão de Poisson</a><ul>
<li class="chapter" data-level="6.1" data-path="regressao-de-poisson.html"><a href="regressao-de-poisson.html#o-modelo-1"><i class="fa fa-check"></i><b>6.1</b> O modelo</a></li>
<li class="chapter" data-level="6.2" data-path="regressao-de-poisson.html"><a href="regressao-de-poisson.html#estimando-os-parametros-do-modelo"><i class="fa fa-check"></i><b>6.2</b> Estimando os parâmetros do modelo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="referencias.html"><a href="referencias.html"><i class="fa fa-check"></i>Referências</a></li>
<li class="divider"></li>
<li><a href="https://smolski.github.io/softwarelivrer/" target="blank">Curso de Extensão</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Software R: curso avançado</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="regressao-logistica" class="section level1">
<h1><span class="header-section-number">Capítulo 5</span> Regressão Logística</h1>
<p>A técnica de regressão logística é uma ferramenta estatística utilizada nas análises preditivas. O interesse em mensurar a probabilidade de um evento ocorrer é extremamente relevante em diversas áreas, como por exemplo em Marketing, Propaganda e Internet, na Aplicação da Lei e Detecção de Fraude, na Assistência Médica, com relação aos Riscos Financeiros e Seguros ou mesmo estudando a Força de Trabalho. É imprescindível elevar o conhecimento sobre quais clientes possuem maior propensão à responder o contato de marketing, quais transações serão fraudulentas, quais e-mails são <em>spam</em>, quem efetivamente fará o pagamento de uma obrigação ou mesmo qual criminoso reincidirá.<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></p>
<div id="o-modelo" class="section level2">
<h2><span class="header-section-number">5.1</span> O modelo</h2>
<p>O modelo de regressão logística é utilizado quando a variável dependente é binária, categórica ordenada ou mesmo categórica desordenada (quando não há relação hierárquica entre elas). Abaixo exemplificam-se algumas perguntas que podem levar a estes três tipos de variáveis.</p>
<table>
<caption><span id="tab:logtip">Tabela 5.1: </span>Tipos de variáveis</caption>
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<tbody>
<tr class="odd">
<td><strong>Variável dependente binária:</strong></td>
<td>Você votou na última eleição?</td>
<td>0 - Não; 1 - Sim</td>
</tr>
<tr class="even">
<td><strong>Variável dependente categórica ordenada:</strong></td>
<td>Você concorda ou desconcorda com o presidente?</td>
<td>1 - Disconcordo; 2 - Neutro; 3 - Concordo</td>
</tr>
<tr class="odd">
<td><strong>Variável dependente categórica não ordenada:</strong></td>
<td>Se as eleições fossem hoje, em que partido você votaria?</td>
<td>1 - Democratas; 2 - Qualquer um; 3 - Republicanos</td>
</tr>
</tbody>
</table>
<p>Fonte: Adaptado de <span class="citation">Torres-Reyna (<a href="#ref-Torres-Reyna2014">2014</a>)</span>.</p>
<p>Nota-se primeiramente que em sendo somente a variável dependente <strong>binária</strong> (0 e 1), é detectada a presença ou não de determinada característica da variável a ser estudada pelo pesquisador. Outros exemplos abrangem a qualificação dos indivíduos estaudados em sendo do sexo feminino (1) ou do sexo masculino (0), se a empresa analisada está inadimplente (1) ou não (0) no mês de referência, etc. Por outro lado, quando a variável dependente é <strong>categórica ordenada</strong>, há uma hierarquia determinada entre as variáveis resposta (neste caso entre Disconcordo, Neutro e Concordo). No terceiro exemplo, a variável resposta é <strong>categórica não ordenada</strong> não possuindo nenhuma relação de ordem entre elas (Democratas, Qualquer um, Republicanos).</p>
<p>A regressão logística a ser estudada neste capítulo será com a variável resposta dependente binária, portanto, tratando os grupos de interesse (variável dependente) com valores de 0 e 1. Sua funcionalidade se ocupa de prever a probabilidade de uma observação estar no grupo igual a 1 (“eventos”), em relação ao grupo igual a zero (“não eventos”).</p>
<p>A previsão da variável dependente depende dos coeficientes logísticos e das variáveis independentes escolhidas ao modelo, lembrando que os valores sempre estarão entre 0 e 1. Convenciona-se que valores de probabilidade acima de 0,50 sejam classificados como pertencendo ao grupo de “eventos”, o que pode distinguir a os resultados preditos e avaliando a precisão preditiva. Utiliza-se a razão de desigualdades - a razão entre as probabilidades dos dois resultados ou eventos: Prob<span class="math inline">\(_{i}/\)</span>(1-Prob<span class="math inline">\(_{i}\)</span>).</p>
<p>Para a estimação dos coeficientes das variáveis independentes, são utilizados o valor logit ou a razão de desigualdades <span class="citation">(Hair et al. <a href="#ref-Hair2009">2009</a>)</span>:</p>
<p><span class="math display">\[
Logit_i=ln\left (\frac{prob_{eventos}}{1-prob_{eventos}}  \right )=b_0+b_1X_1+\ldots+b_nX_n
\]</span></p>
<p>ou</p>
<p><span class="math display">\[
Logit_i=\left (\frac{prob_{eventos}}{1-prob_{eventos}}  \right )=e^{b_0+b_1X_1+\ldots+b_nX_n}
\]</span></p>
<p>Algumas características importantes da regressão logística: a análise é semelhante à regressão linear simples/múltipla (possui a relação entre a variável dependente e a(s) variável(is) independente(s)); possui testes estatísticos diretos, incorporando variáveis métricas e não-métricas, com efeitos não-lineares; é menos afetada pela não satisfação de normalidade dos dados (pois o termo de erro da variável discreta segue a distribuição binomial) e; foi elaborada para que seja prevista a probabilidade de determinado evento ocorrer <span class="citation">(Hair et al. <a href="#ref-Hair2009">2009</a>)</span>.</p>
<p>A regressão logística utiliza a <strong>curva logística</strong> para assim representar a relação entre a variável dependente e as independentes. Os valores previstos portanto permanecem entre 0 e 1, sendo definidos pelos coeficientes estimados. A Figura <a href="regressao-logistica.html#fig:curvalog">5.1</a>a demonstra a relação da curva logistica geral, enquanto a Figura <a href="regressao-logistica.html#fig:curvalog">5.1</a>b mostra uma relação pobremente ajustada dos dados reais e a Figura <a href="regressao-logistica.html#fig:curvalog">5.1</a>c demonstra um bom ajuste na relação entre as variáveis.</p>
<div class="figure" style="text-align: center"><span id="fig:curvalog"></span>
<img src="curvalog.png" alt="Curva logística" width="80%" />
<p class="caption">
Figura 5.1: Curva logística
</p>
</div>
<p>Fonte: Adaptado de <span class="citation">Hair et al. (<a href="#ref-Hair2009">2009</a>)</span>.</p>
<p>A estimação dos coeficientes da regressão logística, ao contrário da regressão múltipla que utiliza o método dos mínimos quadrados, é efetuada pelo uso da <strong>máxima verossimilhança</strong>. Esta, por sua vez, busca encontrar as estimativas mais prováveis dos coeficientes e maximizar a probabilidade de que um evento ocorra. A qualidade do ajuste do modelo é avaliada pelo “pseudo” R<span class="math inline">\(^2\)</span> e pelo exame da precisão preditiva (matriz de confusão).</p>
<p>O valor de verossimilhança é parecido com o procedimento das somas dos quadrados da regressão múltipla, estimando o quão bem o procedimento de máxima verossimilhança se ajusta ao modelo. O ajuste da estimação do modelo dá-se pelo valor -2 vezes o logaritmo da verossimilhança (-2LL), sendo que quando menor este valor, melhor o modelo <span class="citation">(Hair et al. <a href="#ref-Hair2009">2009</a>)</span>.</p>
<p>Para otimizar o tempo do estudante, é recomendada a instalação prévia dos pacotes no RStudio a serem utilizados neste capítulo. Segue abaixo o comando a ser efetuado no console do RStudio:</p>
<p><code>install.packages(c(&quot;readr&quot;,&quot;mfx&quot;,&quot;caret&quot;,&quot;pRoc&quot;,</code></p>
<p><code>&quot;ResourceSelection&quot;,&quot;modEvA&quot;,&quot;foreign&quot;,&quot;stargazer&quot;))</code></p>
<!--
Mais detalhes sobre o modelo de regressão logística podem ser verificados na seção chamada **O Modelo de Regressão Logística**, bem como em @Hosmer2000 e @Gujarati2011.
-->
</div>
<div id="regressao-logistica-simples" class="section level2">
<h2><span class="header-section-number">5.2</span> Regressão Logística Simples</h2>
<p>Este primeiro exemplo tratará da regressão logística simples, portanto, utilizando somente uma variável independente, neste caso numérica. Os dados são originados do livro de <span class="citation">Hosmer e Lemeschow (<a href="#ref-Hosmer2000">2000</a>)</span>, tratando-se de uma amostra com 100 pessoas. A variável dependente é a ocorrência ou não (1 ou 0) de doença coronária cardíaca (CHD), associando-se com a idade (AGE) dos indivíduos, criando assim um modelo de regressão logística.</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb97-1" data-line-number="1"><span class="kw">require</span>(readr)</a></code></pre></div>
<pre><code>Carregando pacotes exigidos: readr</code></pre>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb99-1" data-line-number="1">chd &lt;-<span class="st"> </span><span class="kw">read_delim</span>(<span class="st">&quot;https://goo.gl/uDAAHv&quot;</span>, </a>
<a class="sourceLine" id="cb99-2" data-line-number="2">    <span class="st">&quot;;&quot;</span>, <span class="dt">escape_double =</span> <span class="ot">FALSE</span>, <span class="dt">col_types =</span> <span class="kw">cols</span>(<span class="dt">CHD =</span> <span class="kw">col_factor</span>(<span class="dt">levels =</span> <span class="kw">c</span>())), </a>
<a class="sourceLine" id="cb99-3" data-line-number="3">    <span class="dt">trim_ws =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb99-4" data-line-number="4"></a>
<a class="sourceLine" id="cb99-5" data-line-number="5"><span class="kw">summary</span>(chd)</a></code></pre></div>
<pre><code>      AGE            AGRP      CHD   
 Min.   :20.0   Min.   :1.00   0:57  
 1st Qu.:34.8   1st Qu.:2.75   1:43  
 Median :44.0   Median :4.00         
 Mean   :44.4   Mean   :4.48         
 3rd Qu.:55.0   3rd Qu.:7.00         
 Max.   :69.0   Max.   :8.00         </code></pre>
<p>Observa-se na figura abaixo a dispersão dos “eventos” e dos “nao-eventos” da CHD relacionando-se com a variável idade (AGE).</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb101-1" data-line-number="1"><span class="kw">require</span>(ggplot2)</a>
<a class="sourceLine" id="cb101-2" data-line-number="2"></a>
<a class="sourceLine" id="cb101-3" data-line-number="3"><span class="kw">ggplot</span>(chd, <span class="kw">aes</span>(<span class="dt">x=</span>AGE, <span class="dt">y=</span>CHD)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb101-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb101-5" data-line-number="5"><span class="st">  </span><span class="kw">stat_smooth</span>(<span class="dt">method=</span><span class="st">&quot;glm&quot;</span>, <span class="dt">method.args=</span><span class="kw">list</span>(<span class="dt">family=</span><span class="st">&quot;binomial&quot;</span>), <span class="dt">se=</span><span class="ot">FALSE</span>)</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:dispev"></span>
<img src="index_files/figure-html/dispev-1.png" alt="Dispersão de evendos e não-eventos" width="80%" />
<p class="caption">
Figura 5.2: Dispersão de evendos e não-eventos
</p>
</div>
<p>Monta-se então o modelo de regressão logística com a variável dependente CHD e a variável independente AGE. Abaixo é demonstrada a descrição da equação utilizando o comando <code>summary()</code> para o modelo m1 com a sintaxe básica:</p>
<p><code>glm(Y~modelo, family=binomial(link=&quot;logit&quot;))</code></p>
<p>Assim é obtida a função de ligação estimada do modelo:</p>
<!--
$$
\hat g(CHD) = -5,309 +0,1109AGE
$$
-->
<p><span class="math display">\[
ln\left (\frac{prob_{CHD}}{1-prob_{CHD}}  \right ) = - 5,309 + 0,1109AGE
\]</span></p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb102-1" data-line-number="1">m1=<span class="kw">glm</span>(CHD<span class="op">~</span>AGE, <span class="dt">family =</span> <span class="kw">binomial</span>(<span class="dt">link=</span><span class="st">&quot;logit&quot;</span>), <span class="dt">data =</span> chd)</a>
<a class="sourceLine" id="cb102-2" data-line-number="2"><span class="kw">summary</span>(m1)</a></code></pre></div>
<pre><code>
Call:
glm(formula = CHD ~ AGE, family = binomial(link = &quot;logit&quot;), data = chd)

Deviance Residuals: 
   Min      1Q  Median      3Q     Max  
-1.972  -0.846  -0.458   0.825   2.286  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  -5.3095     1.1337   -4.68  2.8e-06 ***
AGE           0.1109     0.0241    4.61  4.0e-06 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 136.66  on 99  degrees of freedom
Residual deviance: 107.35  on 98  degrees of freedom
AIC: 111.4

Number of Fisher Scoring iterations: 4</code></pre>
<p>Se observa o intercepto com o valor de -5,309, sendo que para a análise aqui proposta da relação entre CHD e AGE não obtém-se um significado prático para este resultado. No entanto, a variável de interesse é idade, que no modelo de regressão obteve o coeficiente de 0,1109. Pelo fato de ser positivo informa que quando a idade (AGE) se eleva, elevam-se as chances de ocorrência de CHD. De igual forma, nota-se que há significância estatística a <span class="math inline">\(p=0,001\)</span> na utilização da variável AGE para o modelo, mostrando que possui importância ao modelo de regressão proposto.</p>
<p>Por fim, o modelo é utilizado para construção da predição de todos os valores das idades de todos os indivíduos desta amostra. Para isto, será criada um novo objeto contendo somente a variável dependente do modelo (AGE) e em sequida, é criada nova coluna constando os valores preditos. Assim, pode ser plotado um gráfico completo com todas as probabilidades desta base de dados:</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb104-1" data-line-number="1"><span class="co"># Filtrando a idade dos indivíduos</span></a>
<a class="sourceLine" id="cb104-2" data-line-number="2">IDADE&lt;-chd[,<span class="dv">1</span>]  </a>
<a class="sourceLine" id="cb104-3" data-line-number="3"></a>
<a class="sourceLine" id="cb104-4" data-line-number="4"><span class="co"># Criando campo de predição para cada idade dos indivíduos </span></a>
<a class="sourceLine" id="cb104-5" data-line-number="5">chd<span class="op">$</span>PRED=<span class="kw">predict</span>(m1, <span class="dt">newdata=</span>IDADE, <span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb104-6" data-line-number="6"></a>
<a class="sourceLine" id="cb104-7" data-line-number="7"><span class="co"># Plotando a probabilidade predita pelo modelo</span></a>
<a class="sourceLine" id="cb104-8" data-line-number="8"><span class="kw">require</span>(ggplot2)</a>
<a class="sourceLine" id="cb104-9" data-line-number="9"><span class="kw">ggplot</span>(chd, <span class="kw">aes</span>(<span class="dt">x=</span>AGE, <span class="dt">y=</span>PRED)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb104-10" data-line-number="10"><span class="st">  </span><span class="kw">geom_point</span>()</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:distrpred"></span>
<img src="index_files/figure-html/distrpred-1.png" alt="Distribuição das probabilidades preditas" width="80%" />
<p class="caption">
Figura 5.3: Distribuição das probabilidades preditas
</p>
</div>
<div id="estimando-a-razao-de-chances" class="section level3">
<h3><span class="header-section-number">5.2.1</span> Estimando a Razão de Chances</h3>
<p>O modelo de regressão logística, porém, traz os resultados dos estimadores na forma logarítma, ou seja, o log das chances da variável idade no modelo é 0,1109. No entanto, para uma interpretação mais enriquecida da relação da idade com o CHD é necessária a transformação deste coeficiente, ou seja, que seja efetuada a exponenciação da(s) variavel(eis) da regressão. Assim, obtém-se a razão das chances (OR - Odds Ratio em inglês) para as variáveis independentes.</p>
<p>Uma maneira prática de se obter a razão de chances no RStudio é utilizando o pacote <span class="math inline">\(mfx\)</span>. Novamente o intercepto não nos interessa nesta análise mas sim a variável AGE. Como demonstrado abaixo, o resultado da razão de chances da variável AGE foi de 1,1173, o que pode assim ser interpretado: para cada variação unitária na idade (AGE), as chances de ocorrência de CHD aumentam 1,1173 vezes. Dito de outra forma, para cada variação unitária em AGE, aumentam-se 11,73% ((1,1173-1)*100) as chances da ocorrência de CHD.</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb105-1" data-line-number="1"><span class="kw">require</span>(mfx)</a>
<a class="sourceLine" id="cb105-2" data-line-number="2"><span class="kw">logitor</span>(CHD<span class="op">~</span>AGE,<span class="dt">data =</span> chd)</a></code></pre></div>
<pre><code>Call:
logitor(formula = CHD ~ AGE, data = chd)

Odds Ratio:
    OddsRatio Std. Err.    z P&gt;|z|    
AGE    1.1173    0.0269 4.61 4e-06 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="determinando-o-intervalo-de-confianca" class="section level3">
<h3><span class="header-section-number">5.2.2</span> Determinando o Intervalo de Confiança</h3>
<p>A determinação do intervalo de confiança do modelo proposto é relevante para que seja analizada a estimativa do intervalo de predição do coeficiente da variável independente, a um nível de confiança de 95%. Desta forma, em 95% dos casos, o parâmetro dos coeficientes estará dentro deste intervalo.</p>
<p>De forma prática é possível determinar os intervalos de confiança com o comando <code>confint()</code> commo observado abaixo, sendo que o coeficiente AGE toma o valor de 1,1173, podendo variar de 1,0692 a 1,1758.</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb107-1" data-line-number="1"><span class="kw">exp</span>(<span class="kw">cbind</span>(<span class="dt">OR=</span><span class="kw">coef</span>(m1), <span class="kw">confint</span>(m1)))</a></code></pre></div>
<pre><code>                  OR     2.5 %  97.5 %
(Intercept) 0.004945 0.0004413 0.03892
AGE         1.117307 1.0692223 1.17587</code></pre>
</div>
<div id="predicao-de-probabilidades" class="section level3">
<h3><span class="header-section-number">5.2.3</span> Predição de Probabilidades</h3>
<p>A partir dos coeficientes do modelo de regressão logística é possível, portanto, efetuar a predição da variável categórica CHD, ou seja, saber a chance de ocorrer CHD com relação à uma determinada idade (AGE). No exemplo abaixo, primeiramente utilizamos a idade média das observações (44,38 anos), criando assim um novo data.frame chamado media. Para utilizar o valor da idade média na função de regressão obtida (<span class="math inline">\(m1\)</span>), utiliza-se a função <code>predict()</code>, de acordo com valor da média encontrada (data.frame media). O resultado mostra que para a idade média da amostra, 44,38 anos, há uma probabilidade de 40,44% na ocorrência da doença CHD. Esta ferramenta permite também a comparação pelo pesquisador das diferentes probabilidades entre as diversas idades (variável AGE).</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb109-1" data-line-number="1">media =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">AGE=</span><span class="kw">mean</span>(chd<span class="op">$</span>AGE))</a>
<a class="sourceLine" id="cb109-2" data-line-number="2">media</a></code></pre></div>
<pre><code>    AGE
1 44.38</code></pre>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb111-1" data-line-number="1">media<span class="op">$</span>pred.prob =<span class="st"> </span><span class="kw">predict</span>(m1, <span class="dt">newdata=</span>media, <span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb111-2" data-line-number="2">media</a></code></pre></div>
<pre><code>    AGE pred.prob
1 44.38    0.4045</code></pre>
</div>
<div id="matriz-de-confusao" class="section level3">
<h3><span class="header-section-number">5.2.4</span> Matriz de Confusão</h3>
<p>Uma maneira prática de qualificar o ajuste do modelo de regressão logística é pela projeção do modelo na tabela de classificação (ou Matriz de Confusão). Para isto, precisa-se criar uma tabela com o resultado da classificação cruzada da variável resposta, de acordo com uma variável dicotômica em que os valores se derivam das probabilidades logísticas estimadas na regressão <span class="citation">(Hosmer e Lemeschow <a href="#ref-Hosmer2000">2000</a>)</span>. No entanto, é preciso definir uma regra de predição, que dirá se houve acerto ou não da probabilidade estimada com os valores reais, pois as probabilidades variam de 0 a 1 enquanto os valores reais binários possuem valores fixos de 0 “ou” 1.</p>
<p>É intuitivo supor que se as probabilidades aproximam-se de 1 o indivíduo estimado pode ser classificado como <span class="math inline">\(\hat Y_i=1\)</span>, bem como de forma contrária, se o modelo estimar probabilidades perto de 0, classificá-la como <span class="math inline">\(\hat Y_i=0\)</span>. Mas qual nível utilizar? Para resolver este problema, é preciso em primeiro lugar determinar um ponto de corte para classificar a estimação como 0 ou 1. Usualmente na literatura se utiliza o valor de 0,5 mas dependendo do estudo proposto pode não ser limitado a este nível <span class="citation">(Hosmer e Lemeschow <a href="#ref-Hosmer2000">2000</a>)</span>.</p>
<p>Após determinado o ponto de corte, é importante avaliar o poder de discriminação do modelo, pelo seu desempenho portanto em classificar os “eventos” dos “não eventos”. Cria-se a Matriz de Confusão (vide Tabela <a href="regressao-logistica.html#tab:matriz">5.2</a>) com as observações de Verdadeiro Positivo (VP), Falso Positivo (FP), Falso Negativo (FN) e Verdadeiro Negativo (VN) e em seguida determinam-se alguns parâmetros numéricos, a serem descritos abaixo:</p>
<p><strong>Precisão</strong>: representa a proporção das predições corretas do modelo sobre o total:</p>
<p><span class="math display">\[
ACC=\frac{VP+VN}{P+N}
\]</span></p>
<p>onde <span class="math inline">\(P\)</span> representa o total de “eventos” positivos (Y=1) e N é o total de “não eventos” (Y=0, ou negativo).</p>
<p><strong>Sensibilidade</strong>: representa a proporção de verdadeiros positivos, ou seja, a capacidade do modelo em avaliar o evento como <span class="math inline">\(\hat Y=1\)</span> (estimado) dado que ele é evento real <span class="math inline">\(Y=1\)</span>:</p>
<p><span class="math display">\[
SENS=\frac{VP}{FN}
\]</span></p>
<p><strong>Especificidade</strong>: a proporção apresentada dos verdadeiros negativos, ou seja, o poder de predição do modelo em avaliar como “não evento” <span class="math inline">\(\hat Y=0\)</span> sendo que ele não é evento <span class="math inline">\(Y=0\)</span>:</p>
<p><span class="math display">\[
SENS=\frac{VN}{VN+FP}
\]</span></p>
<p><strong>Verdadeiro Preditivo Positivo</strong>: se caracteriza como proporção de verdadeiros positivos com relação ao total de predições positivas, ou seja, se o evento é real <span class="math inline">\(Y=1\)</span> dada a classificação do modelo <span class="math inline">\(\hat Y=1\)</span>:</p>
<p><span class="math display">\[
VPP=\frac{VPP}{VN+FP}
\]</span></p>
<p><strong>Verdadeiro Preditivo Negativo</strong>: se caracteriza pela proporção de verdadeiros negativos comparando-se com o total de predições negativas, ou seja, o indivíduo não ser evento <span class="math inline">\(Y=0\)</span> dada classificação do modelo como “não evento” <span class="math inline">\(\hat Y=0\)</span>:</p>
<p><span class="math display">\[
VPN=\frac{VN}{VN+FN}
\]</span></p>
<table style="width:86%;">
<caption><span id="tab:matriz">Tabela 5.2: </span>Matriz de confusão.</caption>
<colgroup>
<col width="27%" />
<col width="16%" />
<col width="27%" />
<col width="13%" />
</colgroup>
<thead>
<tr class="header">
<th></th>
<th></th>
<th><strong>Valor Observado</strong></th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td></td>
<td><span class="math inline">\(Y=1\)</span></td>
<td><span class="math inline">\(Y=0\)</span></td>
</tr>
<tr class="even">
<td><strong>Valor Estimado</strong></td>
<td><span class="math inline">\(\hat Y\)</span>=1</td>
<td>VP</td>
<td>FP</td>
</tr>
<tr class="odd">
<td></td>
<td><span class="math inline">\(\hat Y\)</span>=0</td>
<td>FN</td>
<td>VN</td>
</tr>
</tbody>
</table>
<p>Fonte: Adaptado de <span class="citation">Fawcett (<a href="#ref-Fawcett2006">2006</a>)</span>.</p>
<!--
![Matriz de Confusão](matriz.png)
-->
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb113-1" data-line-number="1"><span class="kw">require</span>(caret)</a></code></pre></div>
<pre><code>Carregando pacotes exigidos: caret</code></pre>
<pre><code>Carregando pacotes exigidos: lattice</code></pre>
<pre><code>
Attaching package: &#39;caret&#39;</code></pre>
<pre><code>The following object is masked from &#39;package:survival&#39;:

    cluster</code></pre>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb118-1" data-line-number="1">chd<span class="op">$</span>pdata &lt;-<span class="st"> </span><span class="kw">as.factor</span>(</a>
<a class="sourceLine" id="cb118-2" data-line-number="2">    <span class="kw">ifelse</span>(</a>
<a class="sourceLine" id="cb118-3" data-line-number="3">        <span class="kw">predict</span>(m1, </a>
<a class="sourceLine" id="cb118-4" data-line-number="4">                <span class="dt">newdata =</span> chd, </a>
<a class="sourceLine" id="cb118-5" data-line-number="5">                <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb118-6" data-line-number="6">        <span class="op">&gt;</span><span class="fl">0.5</span>,<span class="st">&quot;1&quot;</span>,<span class="st">&quot;0&quot;</span>))</a>
<a class="sourceLine" id="cb118-7" data-line-number="7"></a>
<a class="sourceLine" id="cb118-8" data-line-number="8"><span class="kw">confusionMatrix</span>(chd<span class="op">$</span>pdata, chd<span class="op">$</span>CHD, <span class="dt">positive=</span><span class="st">&quot;1&quot;</span>)</a></code></pre></div>
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction  0  1
         0 45 14
         1 12 29
                                        
               Accuracy : 0.74          
                 95% CI : (0.643, 0.823)
    No Information Rate : 0.57          
    P-Value [Acc &gt; NIR] : 0.000319      
                                        
                  Kappa : 0.467         
 Mcnemar&#39;s Test P-Value : 0.844519      
                                        
            Sensitivity : 0.674         
            Specificity : 0.789         
         Pos Pred Value : 0.707         
         Neg Pred Value : 0.763         
             Prevalence : 0.430         
         Detection Rate : 0.290         
   Detection Prevalence : 0.410         
      Balanced Accuracy : 0.732         
                                        
       &#39;Positive&#39; Class : 1             
                                        </code></pre>
<p>A matriz de confusão retoma uma excelente acurácia total do modelo em 74%, sendo que o modelo consegue acertos de 70,7% na predição de valores positivos ou dos “eventos” (29/41) e 76,3% na predição de valores negativos ou os “não eventos” (45/59).</p>
</div>
<div id="curva-roc" class="section level3">
<h3><span class="header-section-number">5.2.5</span> Curva ROC</h3>
<p>A Curva ROC (Receiver Operating Characteristic Curve) associada ao modelo logístico mensura a capacidade de predição do modelo proposto, através das predições da sensibilidade e da especificidade. Segundo <span class="citation">Fawcett (<a href="#ref-Fawcett2006">2006</a>)</span> esta técnica serve para visualizar, organizar e classificar o modelo com base na performance preditiva.</p>
<p>A curva ROC é produzida bi-dimensionalmente como mostra a Figura <a href="regressao-logistica.html#fig:curvaroc">5.4</a>a, pela obtenção da relação entre a taxa dos verdadeiros positivos do modelo e da taxa dos falsos positivos preditos. Desta forma, o ponto inferior esquerdo (0,0) significa que não é predita uma classificação positiva; no canto oposto do gráfico (1,1) classifica os resultados incondicionalmente positivos e; o ponto (0,1) representa uma excelente classificação. Quanto mais ao noroeste do gráfico o ponto estiver melhor, assim sendo o ponto B da Figura <a href="regressao-logistica.html#fig:curvaroc">5.4</a>a classifica melhor os resultados que o ponto C.</p>
<div class="figure" style="text-align: center"><span id="fig:curvaroc"></span>
<img src="curvaroc.png" alt="Curva ROC" width="80%" />
<p class="caption">
Figura 5.4: Curva ROC
</p>
</div>
<p>Fonte: Adaptado de <span class="citation">Fawcett (<a href="#ref-Fawcett2006">2006</a>)</span>.</p>
<p>A Figura <a href="regressao-logistica.html#fig:curvaroc">5.4</a>b mostra a formação da curva ROC para um teste com 20 instâncias, uma amostra pequena servindo portanto de exemplificação da sua criação. Para isto, o modelo de regressão logística é rodado randomicamente e a predição resultante é comparada com o valor real da variável dependente. O ponto de corte padrão, como visto anteriormente, é o valor de 0,5: acima deste valor, a predição é classificada como 1 e, abaixo dele 0. Na Figura <a href="regressao-logistica.html#fig:curvaroc">5.4</a>b, a primeira predição foi 0,9 e a segunda 0,8 sendo que como estão mais perto do eixo X do gráfico, representam predições acertadas. Já para predições que não foram acertadas (como no exemplo as predições 0,7 e 0,54 por exemplo) a curva caminha para a direita. A lógica se mantém até o final da elaboração da curva.</p>
<p>Já na Figura <a href="regressao-logistica.html#fig:curvaroc">5.4</a>c é demonstrada a elaboração do conceito da Área sobre a Curva ROC (AUC - Area Under the ROC Curve), que objetiva comparar os classificadores a partir da parformance da curva em um único valor escalar <span class="citation">(Fawcett <a href="#ref-Fawcett2006">2006</a>)</span>. Este indicador representa a probabilidade de que o classificador efetue predições randômicas na instância positiva melhor do que na instância negativa.
O indicador AUC sempre terá seu valor entre 0 e 1, sendo que quanto maior, melhor e nunca um classificador realístico deve estar abaixo de 0,5. <span class="citation">Hosmer e Lemeschow (<a href="#ref-Hosmer2000">2000</a>)</span> sugere a utilização de AUC acima de 0,7 como aceitável. Como exemplo, a Figura <a href="regressao-logistica.html#fig:curvaroc">5.4</a>c mostra que a curva ROC B tem uma melhor capacidade preditiva que a curva A.</p>
<p>Seguem os passos para elaboração da curva ROC.</p>
<ul>
<li>Passo 1:</li>
</ul>
<p><code>require(pROC)</code></p>
<p><code>roc1=plot.roc(chd$CHD,fitted(m1))</code></p>
<ul>
<li>Passo 2:</li>
</ul>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb120-1" data-line-number="1"><span class="kw">plot</span>(roc1,</a>
<a class="sourceLine" id="cb120-2" data-line-number="2">     <span class="dt">print.auc=</span><span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb120-3" data-line-number="3">     <span class="dt">auc.polygon=</span><span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb120-4" data-line-number="4">     <span class="dt">grud=</span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.2</span>),</a>
<a class="sourceLine" id="cb120-5" data-line-number="5">     <span class="dt">grid.col=</span><span class="kw">c</span>(<span class="st">&quot;green&quot;</span>,<span class="st">&quot;red&quot;</span>), </a>
<a class="sourceLine" id="cb120-6" data-line-number="6">     <span class="dt">max.auc.polygon=</span><span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb120-7" data-line-number="7">     <span class="dt">auc.polygon.col=</span><span class="st">&quot;lightgreen&quot;</span>, </a>
<a class="sourceLine" id="cb120-8" data-line-number="8">     <span class="dt">print.thres=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:roc"></span>
<img src="index_files/figure-html/roc-1.png" alt="Curva Roc" width="80%" />
<p class="caption">
Figura 5.5: Curva Roc
</p>
</div>
</div>
<div id="o-teste-hosmer-e-lemeshow" class="section level3">
<h3><span class="header-section-number">5.2.6</span> O teste Hosmer e Lemeshow</h3>
<p>O teste de Hosmer e Lemeshow é utilizado para demonstrar a qualidade do ajuste do modelo, ou seja, se o modelo pode explicar os dados observados. Para este teste, os dados são divididos de acordo com as probabilidades previstas em 10 grupos iguais, sendo que os números previstos e os reais são comparados com a estatística do qui-quadrado. <span class="citation">Hair et al. (<a href="#ref-Hair2009">2009</a>)</span> sugerem um tamanho de amostra de pelo menos 50 casos para a realização deste teste.</p>
<p>A hipótese nula H<span class="math inline">\({_0}\)</span> do qui-quadrado (<code>p=0,05</code>) deste teste é a de que as proporções observadas e esperadas são as mesmas ao longo da amostra. Abaixo segue a estrutura do teste, sendo que o modelo apresenta dificuldade de ajuste em função de que rejeita a hipótese nula a <em>p=0,05</em>.</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb121-1" data-line-number="1"><span class="kw">require</span>(ResourceSelection)</a>
<a class="sourceLine" id="cb121-2" data-line-number="2">hl=<span class="kw">hoslem.test</span>(chd<span class="op">$</span>CHD,<span class="kw">fitted</span>(m1),<span class="dt">g=</span><span class="dv">10</span>)</a>
<a class="sourceLine" id="cb121-3" data-line-number="3">hl</a></code></pre></div>
<pre><code>
    Hosmer and Lemeshow goodness of fit (GOF) test

data:  chd$CHD, fitted(m1)
X-squared = 100, df = 8, p-value &lt;2e-16</code></pre>
</div>
<div id="pseudo-r2" class="section level3">
<h3><span class="header-section-number">5.2.7</span> Pseudo R<span class="math inline">\(^2\)</span></h3>
<p>Semelhante ao coeficiente de determinação R<span class="math inline">\({^2}\)</span> da regressão múltipla, a medida de pseudo R<span class="math inline">\({^2}\)</span> representam o ajuste geral do modelo proposto. Sua interpretação, portanto, é semelhante à regressão múltipla. Abaixo segue o cálculo do pseudo R<span class="math inline">\({^2}\)</span>:</p>
<p><span class="math display">\[
R{^2}_{LOGIT} = \frac{-2LL_{nulo}-(-2LL_{modelo})}{-2LL_{nulo}}
\]</span>
Lembrando que o valor -2LL representa -2 vezes o logaritmo do valor de verossimilhança, onde a verossimilhança do modelo nulo é comparado com o modelo completo. Abaixo mostra-se o código para calcular os indicadores, sendo que constam as medidas de pseudo R<span class="math inline">\({^2}\)</span> estipuladas por Cox e Snell, Nagelkerke e McFadden.</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb123-1" data-line-number="1"><span class="kw">require</span>(modEvA)</a>
<a class="sourceLine" id="cb123-2" data-line-number="2"><span class="kw">RsqGLM</span>(m1)</a></code></pre></div>
<pre><code>$CoxSnell
[1] 0.2541

$Nagelkerke
[1] 0.341

$McFadden
[1] 0.2145

$Tjur
[1] 0.2706

$sqPearson
[1] 0.2726</code></pre>
</div>
</div>
<div id="regressao-logistica-multipla" class="section level2">
<h2><span class="header-section-number">5.3</span> Regressão Logística Múltipla</h2>
<p>O exemplo abaixo abordado foi extraído de <span class="citation">Torres-Reyna (<a href="#ref-Torres-Reyna2014">2014</a>)</span>, onde observa-se o banco de dados criado chamado <code>mydata</code>, possuindo as variáveis<code>country</code>,<code>year</code>,<code>y</code>,<code>y_bin</code>,<code>x1</code>,<code>x2</code>,<code>x3</code> e<code>opinion</code>. A variável dependente é <code>y_bin</code>, da qual foi categorizada entre 0 e 1 conforme a ocorrência de valores negativos em<code>y</code>. As variáveis independentes do modelo serão<code>x1</code>,<code>x2</code>e<code>x3</code>.</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb125-1" data-line-number="1"><span class="kw">require</span>(haven)</a></code></pre></div>
<pre><code>Carregando pacotes exigidos: haven</code></pre>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb127-1" data-line-number="1">mydata &lt;-<span class="st"> </span><span class="kw">read_dta</span>(<span class="st">&quot;http://dss.princeton.edu/training/Panel101.dta&quot;</span>) </a>
<a class="sourceLine" id="cb127-2" data-line-number="2"><span class="kw">summary</span>(mydata)</a></code></pre></div>
<pre><code>    country       year            y                 y_bin           x1        
 Min.   :1   Min.   :1990   Min.   :-7.86e+09   Min.   :0.0   Min.   :-0.568  
 1st Qu.:2   1st Qu.:1992   1st Qu.: 2.47e+08   1st Qu.:1.0   1st Qu.: 0.329  
 Median :4   Median :1994   Median : 1.90e+09   Median :1.0   Median : 0.641  
 Mean   :4   Mean   :1994   Mean   : 1.85e+09   Mean   :0.8   Mean   : 0.648  
 3rd Qu.:6   3rd Qu.:1997   3rd Qu.: 3.37e+09   3rd Qu.:1.0   3rd Qu.: 1.096  
 Max.   :7   Max.   :1999   Max.   : 8.94e+09   Max.   :1.0   Max.   : 1.446  
       x2               x3            opinion    
 Min.   :-1.622   Min.   :-1.165   Min.   :1.00  
 1st Qu.:-1.216   1st Qu.:-0.079   1st Qu.:1.00  
 Median :-0.462   Median : 0.514   Median :2.50  
 Mean   : 0.134   Mean   : 0.762   Mean   :2.44  
 3rd Qu.: 1.608   3rd Qu.: 1.155   3rd Qu.:3.00  
 Max.   : 2.530   Max.   : 7.169   Max.   :4.00  </code></pre>
<p>Utiliza-se uma função para Modelos Lineares Generalizados (glm - em inglês Generalized Linear Models), determinando a variável dependente (y_bin), as variáveis independentes <code>(x1+x2+x3)</code>, a base de dados a ser utilizada <code>(data=mydata)</code> e a família dos modelos <code>(family = binomial(link=&quot;logit&quot;))</code>.</p>
<p>Abaixo os resultados da estimação do modelo utilizando o comando <code>summary</code>. Observa-se que os valores <code>estimados</code> mostram os coeficientes em formato logarítmo de chances. Assim, quando x3 eleva-se em 1 (uma) unidade, o log das chances esperado para x3 altera-se em 0,7512. Neste ponto, observa-se que as três variáveis independentes possuem efeitos positivos para determinação das chances do preditor ser igual a 1, caso contrário constariam com sinal negativo. A coluna <span class="math inline">\(Pr(&gt;|z|)\)</span> traz os p-valores das variáveis indicando o teste da hipótese nula. Como resultado a variável x3 revelou significância estatística a 10% ($&lt;$0,10), no entanto o valor usual para considerá-la estatísticamente significante é 5% (0,05). Para fins de explanação do modelo, neste trabalho, serão efetuadas as demais análises do modelo de forma explicativa.</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb129-1" data-line-number="1">logit=<span class="kw">glm</span>(y_bin<span class="op">~</span>x1<span class="op">+</span>x2<span class="op">+</span>x3, <span class="dt">data=</span>mydata, <span class="dt">family =</span> <span class="kw">binomial</span>(<span class="dt">link=</span><span class="st">&quot;logit&quot;</span>))</a>
<a class="sourceLine" id="cb129-2" data-line-number="2"><span class="kw">summary</span>(logit)</a></code></pre></div>
<pre><code>
Call:
glm(formula = y_bin ~ x1 + x2 + x3, family = binomial(link = &quot;logit&quot;), 
    data = mydata)

Deviance Residuals: 
   Min      1Q  Median      3Q     Max  
-2.028   0.235   0.554   0.702   1.084  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)  
(Intercept)    0.426      0.639    0.67    0.505  
x1             0.862      0.784    1.10    0.272  
x2             0.367      0.308    1.19    0.234  
x3             0.751      0.455    1.65    0.099 .
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 70.056  on 69  degrees of freedom
Residual deviance: 65.512  on 66  degrees of freedom
AIC: 73.51

Number of Fisher Scoring iterations: 5</code></pre>
<!--
%Uma forma eficiente para construção da tabela com os resultados do modelo é a utilização do pacote \textbf{stargazer}, sendo que após instalado (install.packages("stargazer")),  utiliza-se o comando \textbf{stargazer(logit, title="seu título")} ou \textbf{stargazer(logit, title="seu título", type="text")} (plotando assim os resultados diretamente no console do RStudio) para plotagem dos resultados, como segue:
-->
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb131-1" data-line-number="1"><span class="kw">require</span>(stargazer)</a>
<a class="sourceLine" id="cb131-2" data-line-number="2"><span class="kw">stargazer</span>(logit, <span class="dt">title=</span><span class="st">&quot;Resultados&quot;</span>,<span class="dt">type =</span> <span class="st">&quot;text&quot;</span>)</a></code></pre></div>
<pre><code>
Resultados
=============================================
                      Dependent variable:    
                  ---------------------------
                             y_bin           
---------------------------------------------
x1                           0.862           
                            (0.784)          
                                             
x2                           0.367           
                            (0.308)          
                                             
x3                          0.751*           
                            (0.455)          
                                             
Constant                     0.426           
                            (0.639)          
                                             
---------------------------------------------
Observations                  70             
Log Likelihood              -32.760          
Akaike Inf. Crit.           73.510           
=============================================
Note:             *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</code></pre>
<p>A razão de chances (OR - odds ratio em inglês) estimada no modelo terá de ser transformada por estar apresentada na forma logarítma conforme o modelo de regressão logística o estima. Assim, utiliza-se o pacote <code>mfx</code> para efetuar esta transformação para todo o modelo de forma automatizada <code>(logitor(y_bin~x1+x2+x3,data=mydata))</code>:</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb133-1" data-line-number="1"><span class="kw">require</span>(mfx)</a>
<a class="sourceLine" id="cb133-2" data-line-number="2"><span class="kw">logitor</span>(y_bin<span class="op">~</span>x1<span class="op">+</span>x2<span class="op">+</span>x3,<span class="dt">data=</span>mydata)</a></code></pre></div>
<pre><code>Call:
logitor(formula = y_bin ~ x1 + x2 + x3, data = mydata)

Odds Ratio:
   OddsRatio Std. Err.    z P&gt;|z|  
x1     2.367     1.856 1.10 0.272  
x2     1.443     0.445 1.19 0.234  
x3     2.120     0.964 1.65 0.099 .
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>O resultado acima evidencia que para uma alteração em 1 (uma) unidade em x3, a chance de que y seja igual a 1 aumenta em 112% ((2,12-1)*100). Dito de outra forma, a chance de y=1 é 2,12 vezes maior quando x3 aumenta em uma unidade (sendo que aqui mantêm-se as demais variáveis independentes constantes).</p>
<p>Como visto, para cada variação unitária em x3 o log das chances varia 0,7512. É possível estimar, portanto, a alteração das chances em função das médias dos valores de cada variável x1 e x2, e utilizar como exemplo os valores de 1, 2 e 3 para x3, para assim alcançar os preditores do log das chances nesta simulação, como segue abaixo:</p>
<p>Para facilitar a interpretação do modelo, se torna mais fácil depois de transformado a sua exponenciação dos coeficientes logísticos utilizando o comando <code>exp(coef(logit))</code>. Desta forma, para cada incremento unitário em x2 e mantendo as demais variáveis constantes, conclui-se que é 1,443 vezes provável que y seja igual a 1 em oposição a não ser (igual a zero), ou seja, as chances aumentam em 44,30%.</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb135-1" data-line-number="1"><span class="kw">exp</span>(<span class="kw">coef</span>(logit))</a></code></pre></div>
<pre><code>(Intercept)          x1          x2          x3 
      1.531       2.367       1.443       2.120 </code></pre>
<p>O <strong>intervalo de confiança</strong> do modelo pode ser exposto utilizando o comando <code>confint</code> para os coeficientes estimados, como segue abaixo:</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb137-1" data-line-number="1"><span class="kw">exp</span>(<span class="kw">cbind</span>(<span class="dt">OR=</span><span class="kw">coef</span>(logit), <span class="kw">confint</span>(logit)))</a></code></pre></div>
<pre><code>               OR  2.5 % 97.5 %
(Intercept) 1.531 0.4387  5.625
x1          2.367 0.5129 11.675
x2          1.443 0.8041  2.738
x3          2.120 1.0039  5.719</code></pre>
<p>A partir do modelo logístico, podemos realizar <strong>predições das probabilidades</strong> de se encontrar o resultado y=1 conforme visto acima. Para isto, como exercício utilizaremos as médias das observações de cada variável independente do modelo. Em primeiro lugar deve ser criado um data.frame com os valores médios, como segue:</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb139-1" data-line-number="1">allmean =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x1=</span><span class="kw">mean</span>(mydata<span class="op">$</span>x1),</a>
<a class="sourceLine" id="cb139-2" data-line-number="2">                     <span class="dt">x2=</span><span class="kw">mean</span>(mydata<span class="op">$</span>x2),</a>
<a class="sourceLine" id="cb139-3" data-line-number="3">                     <span class="dt">x3=</span><span class="kw">mean</span>(mydata<span class="op">$</span>x3))</a>
<a class="sourceLine" id="cb139-4" data-line-number="4">allmean</a></code></pre></div>
<pre><code>     x1     x2     x3
1 0.648 0.1339 0.7619</code></pre>
<p>Utiliza-se o comando <code>predict()</code> para predição do modelo, como segue abaixo, informando o objeto criado com a equação do modelo (logit), a base de dados com as condições dos valores médios (allmean) e o tipo de teste requerido (“response”) para predizer as probabilidades. Como resultado, o modelo informa que constando os valores médios das variáveis independentes, obtêm-se a probabilidade de 83% em y se constituir igual a 1.</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb141-1" data-line-number="1">allmean<span class="op">$</span>pred.prob =<span class="st"> </span><span class="kw">predict</span>(logit, <span class="dt">newdata=</span>allmean, <span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb141-2" data-line-number="2">allmean</a></code></pre></div>
<pre><code>     x1     x2     x3 pred.prob
1 0.648 0.1339 0.7619    0.8329</code></pre>
<div id="metodo-stepwise" class="section level3">
<h3><span class="header-section-number">5.3.1</span> Método Stepwise</h3>
<p>O método Stepwise auxilia o pesquisador em selecionar as variáveis importantes ao modelo, sendo que podem ser utilizadas nas direções “both”, “backward”, “forward”. Este método, por sua vez, utiliza o Critério de Informação de Akaike (AIC - Akaike Information Criterion) na combinação das variáveis dos diversos modelos simulados para selecionar o modelo mais ajustado. Quanto menor o AIC, melhor o ajuste do modelo. O AIC é calculado da seguitne forma:</p>
<p><span class="math display">\[
AIC = -2log(L_{p})+2[(p+1)+1]
\]</span>
onde <span class="math inline">\(L_{p}\)</span> é a função de máxima verossimilhança e <span class="math inline">\(p\)</span> é o número de variáveis explicativas do modelo. Segue o código para execução no console:</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb143-1" data-line-number="1"><span class="kw">step</span>(logit, <span class="dt">direction =</span> <span class="st">&#39;both&#39;</span>)</a></code></pre></div>
<pre><code>Start:  AIC=73.51
y_bin ~ x1 + x2 + x3

       Df Deviance  AIC
- x1    1     66.7 72.7
- x2    1     67.0 73.0
&lt;none&gt;        65.5 73.5
- x3    1     69.4 75.4

Step:  AIC=72.74
y_bin ~ x2 + x3

       Df Deviance  AIC
- x2    1     67.3 71.3
&lt;none&gt;        66.7 72.7
+ x1    1     65.5 73.5
- x3    1     70.0 74.0

Step:  AIC=71.33
y_bin ~ x3

       Df Deviance  AIC
&lt;none&gt;        67.3 71.3
- x3    1     70.1 72.1
+ x2    1     66.7 72.7
+ x1    1     67.0 73.0</code></pre>
<pre><code>
Call:  glm(formula = y_bin ~ x3, family = binomial(link = &quot;logit&quot;), 
    data = mydata)

Coefficients:
(Intercept)           x3  
      1.134        0.487  

Degrees of Freedom: 69 Total (i.e. Null);  68 Residual
Null Deviance:      70.1 
Residual Deviance: 67.3     AIC: 71.3</code></pre>
</div>
<div id="vif---variance-inflation-factor" class="section level3">
<h3><span class="header-section-number">5.3.2</span> VIF - Variance Inflation Factor</h3>
<p>Os problemas de multicolinearedade nos modelos de regressão, ou seja, as relações entre as variáveis do modelo, podem prejudicar a capacidade preditiva do mesmo. Nas palavras de <span class="citation">Hair et al. (<a href="#ref-Hair2009">2009</a>, 191)</span>, “multicolinearidade cria variância “compartilhada” entre variáveis, diminuindo assim a capacidade de prever a medida dependente, bem como averiguar os papéis relativos de cada variável independente”.
Para resolver esta questão, utiliza-se o teste do fator de inflação da variância (VIF - Variance Inflation Factor), índice o qual não deve ficar abaixo de 10 para representar baixo problema de multicolinearidade segundo <span class="citation">Rawlings, Pantula, e Dickey (<a href="#ref-Rawlings1998">1998</a>)</span>.</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb146-1" data-line-number="1"><span class="kw">require</span>(faraway)</a>
<a class="sourceLine" id="cb146-2" data-line-number="2"><span class="kw">vif</span>(logit)</a></code></pre></div>
<pre><code>    x1     x2     x3 
 9.292 12.318 29.860 </code></pre>
</div>
</div>
<div id="regressao-logistica-multipla-com-variavel-categorica" class="section level2">
<h2><span class="header-section-number">5.4</span> Regressão Logística Múltipla com variável categórica</h2>
<p>Agora segue um exemplo de regressão logística utilizando uma variável dependente categórica juntamente com variáveis numéricas. Trata-se de uma base de dados em que o interesse é descobrir a probabilidade de um aluno ser admitido no vestibular com base no ranqueamento de escola em que estudou no ensino médio, bem como nas notas do aluno nas provas do Gpa (Grade Point Average - uma nota de performance dos alunos nos Estados Unidos) e do Gre (Graduate Record Examinations - exame padrão que qualifica o estudante para o ensino superior nos Estados Unidos). Seguem as variáveis.</p>
<ul>
<li><strong>admin</strong>: Variável dependente = 0 (não admitido) e 1 (admitido)</li>
<li><strong>Rank</strong>: Variável independente = ranking da escola de proveniência do candidato</li>
<li><strong>Gre</strong>: Variável independente = exames prévios do candidato.</li>
<li><strong>Gpa</strong>: Variável independente = exames prévios do candidato.</li>
</ul>
<p>Abaixo seguem os resultados do modelo, partindo-se do carregamento dos dados. É observado que as variáveis <strong>gre</strong> e <strong>gpa</strong> obtiveram significância estatística em 10%, bem como rank2, já rank3 e rank4 obtiveram <code>p=0,001</code>. A variância do modelo nulo
ficou em 499,98 e com a inclusão das variáveis ao modelo baixou para 458,52, o que mostra que contribuíram para explicação da variável dependente.</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb148-1" data-line-number="1"><span class="co"># Carregando o arquivo</span></a>
<a class="sourceLine" id="cb148-2" data-line-number="2"><span class="kw">require</span>(readr)</a>
<a class="sourceLine" id="cb148-3" data-line-number="3">binary &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;http://www.karlin.mff.cuni.cz/~pesta/prednasky/NMFM404/Data/binary.csv&quot;</span>)</a>
<a class="sourceLine" id="cb148-4" data-line-number="4"></a>
<a class="sourceLine" id="cb148-5" data-line-number="5"><span class="co"># Transformando a variável rank em categórica</span></a>
<a class="sourceLine" id="cb148-6" data-line-number="6">binary<span class="op">$</span>rank &lt;-<span class="st"> </span><span class="kw">factor</span>(binary<span class="op">$</span>rank)</a>
<a class="sourceLine" id="cb148-7" data-line-number="7"></a>
<a class="sourceLine" id="cb148-8" data-line-number="8"><span class="co"># Determinando a regressão</span></a>
<a class="sourceLine" id="cb148-9" data-line-number="9">mylogit &lt;-<span class="st"> </span><span class="kw">glm</span>(admit <span class="op">~</span><span class="st"> </span>gre <span class="op">+</span><span class="st"> </span>gpa <span class="op">+</span><span class="st"> </span>rank, <span class="dt">data =</span> binary, </a>
<a class="sourceLine" id="cb148-10" data-line-number="10">               <span class="dt">family =</span> <span class="kw">binomial</span>(<span class="dt">link=</span><span class="st">&quot;logit&quot;</span>))</a>
<a class="sourceLine" id="cb148-11" data-line-number="11"></a>
<a class="sourceLine" id="cb148-12" data-line-number="12"><span class="co"># Resultado</span></a>
<a class="sourceLine" id="cb148-13" data-line-number="13"><span class="kw">summary</span>(mylogit)</a></code></pre></div>
<pre><code>
Call:
glm(formula = admit ~ gre + gpa + rank, family = binomial(link = &quot;logit&quot;), 
    data = binary)

Deviance Residuals: 
   Min      1Q  Median      3Q     Max  
-1.627  -0.866  -0.639   1.149   2.079  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -3.98998    1.13995   -3.50  0.00047 ***
gre          0.00226    0.00109    2.07  0.03847 *  
gpa          0.80404    0.33182    2.42  0.01539 *  
rank2       -0.67544    0.31649   -2.13  0.03283 *  
rank3       -1.34020    0.34531   -3.88  0.00010 ***
rank4       -1.55146    0.41783   -3.71  0.00020 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 499.98  on 399  degrees of freedom
Residual deviance: 458.52  on 394  degrees of freedom
AIC: 470.5

Number of Fisher Scoring iterations: 4</code></pre>
<p>Utilizando o teste de análise de variância <code>anova</code> pode-se observar a variância com o modelo nulo (500) e à medida que as variáveis explicativas foram sendo incluídas, estas reduziram a variância do modelo para 459, contribuindo para o modelo.</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb150-1" data-line-number="1"><span class="kw">anova</span>(mylogit, <span class="dt">test =</span> <span class="st">&quot;Chisq&quot;</span>)</a></code></pre></div>
<pre><code>Analysis of Deviance Table

Model: binomial, link: logit

Response: admit

Terms added sequentially (first to last)

     Df Deviance Resid. Df Resid. Dev Pr(&gt;Chi)    
NULL                   399        500             
gre   1    13.92       398        486  0.00019 ***
gpa   1     5.71       397        480  0.01685 *  
rank  3    21.83       394        459  7.1e-05 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Caso seja interessante comparar diversos modelos de regressão com variáveis explicativas distintas, estes podem ser comparados no teste de variância <code>anova</code>. Utilizando a função <code>update</code> pode ser criada uma nova regressão com base na regressão anterior (<code>mylogit</code>) e é excluído do modelo a variável <code>gre</code> para exemplificar. Após, é efetuado novamente o teste <code>anova</code>, agora comparando os dois modelos, como segue abaixo. Evidencia-se que a exclusão da variável <code>gre</code> causou elevaçãod a variância do modelo para 463, piorando portanto a capacidade do modelo pois espera-se sempre reduções na sua variância.</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb152-1" data-line-number="1"><span class="co"># Criação de novo modelo com base no anterior</span></a>
<a class="sourceLine" id="cb152-2" data-line-number="2">mylogit2=<span class="kw">update</span>(mylogit,<span class="op">~</span>. <span class="op">-</span><span class="st"> </span>gre)</a>
<a class="sourceLine" id="cb152-3" data-line-number="3"><span class="co"># </span></a>
<a class="sourceLine" id="cb152-4" data-line-number="4"><span class="kw">anova</span>(mylogit,mylogit2, <span class="dt">test =</span> <span class="st">&quot;Chisq&quot;</span>)</a></code></pre></div>
<pre><code>Analysis of Deviance Table

Model 1: admit ~ gre + gpa + rank
Model 2: admit ~ gpa + rank
  Resid. Df Resid. Dev Df Deviance Pr(&gt;Chi)  
1       394        459                       
2       395        463 -1    -4.36    0.037 *
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Voltando ao modelo determinado anteriormente (<code>mylogit</code>), observa-se que os parâmetros da regressão logística proposta utilizando todas as variáveis foram assim determinados:</p>
<p><span class="math display">\[
ln(P=Y) = 
-3,98998 + 0.00226gre + 0,80404gpa -0,67544rank2 -1,34020rank3 -1,55146rank4
\]</span></p>
<p>Determinam-se os coeficientes exponenciados (as razões de chance) para cada variável do modelo, bem como seus intervalos de confiança:</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb154-1" data-line-number="1"><span class="kw">exp</span>(<span class="kw">cbind</span>(<span class="dt">OR =</span> <span class="kw">coef</span>(mylogit), <span class="kw">confint</span>(mylogit)))</a></code></pre></div>
<pre><code>                OR    2.5 % 97.5 %
(Intercept) 0.0185 0.001889 0.1665
gre         1.0023 1.000138 1.0044
gpa         2.2345 1.173858 4.3238
rank2       0.5089 0.272290 0.9448
rank3       0.2618 0.131642 0.5115
rank4       0.2119 0.090716 0.4707</code></pre>
<p>A leitura dos resultados, para as variáveis numéricas continua sendo a mesma. Com relação ao resultado para a variável <strong>gre</strong>, para cada aumento unitário nesta variável, mantendo-se as demais constantes, elevam-se em 0,23% ((1,0023-1)*100) as chances de que o aluno seja aprovado no vestibular. Já para a cada variação unitária na variável <strong>gpa</strong>, aumentam em 123,45% ((2,2345-1)*100).
Dito de outra forma, para cada elevação em <strong>gpa</strong> aumentam 2,2345 vezes as chances em ser aprovado no vestibular. Tais resultados vão de encontro ao conceito teórico de que quanto melhor a nota do aluno em exame prévios maiores as chances de este aluno passar no vestibular.</p>
<p>Outra questão é sobre o <em>ranking</em> das escolas que os alunos estudaram. Será que aqueles que estudaram em escolas melhores ranqueadas possuem mais chances de passar no vestibular? A variável <strong>rank</strong> traz esta análise, sendo que como é uma variável categórica (pois retoma as categorias de 1 a 4), as comparações das chances de que o aluno passe no vestibular são comparadas com a escola de <em>ranking</em> 1.</p>
<p>Desta forma, em sendo o aluno proveniente de uma escola de <em>ranking</em> 2, diminuem-se as chances em 49,11% ((0,5089-1)$<em>$100) de que o aluno passe no vestibular. Já para os alunos que estudaramem uma escola de </em>ranking* 3 tem 73,82% ((0,2618-1)*100) menos chances de passar no vestibular.
Pioram ainda mais as chances de passar no vestibular daqueles alunos que estudaram em uma escola de <em>ranking</em> 4: diminuem-se em 78,81% as chances de que estes aluno passe no vestibular, mantidas as demais veriáveis.</p>
<p><strong>Predição das probabilidades</strong>: a partir da equação de regressão logística auferida neste exemplo, qual é a probabilidade de que um aluno que tirou nota no <strong>gre</strong> de 700, no <strong>gpa</strong> de 3,67 e estudou em uma escola de <em>ranking</em> 1 passe no vestibular?
Nota-se que a probabilidade de que este aluno passe no vestibular é de 63,32%. Segue a predição para estas variáveis:</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb156-1" data-line-number="1">pred=<span class="kw">data.frame</span>(<span class="dt">gre=</span><span class="dv">700</span>,</a>
<a class="sourceLine" id="cb156-2" data-line-number="2">                <span class="dt">gpa=</span><span class="fl">3.67</span>,</a>
<a class="sourceLine" id="cb156-3" data-line-number="3">                <span class="dt">rank=</span><span class="kw">factor</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb156-4" data-line-number="4">                )</a>
<a class="sourceLine" id="cb156-5" data-line-number="5">pred<span class="op">$</span>prob=<span class="kw">predict</span>(mylogit, <span class="dt">newdata=</span>pred, <span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb156-6" data-line-number="6">pred</a></code></pre></div>
<pre><code>  gre  gpa rank   prob
1 700 3.67    1 0.6332</code></pre>
<p>Comparando com um aluno que tirou as mesmas notas no <strong>gre</strong> e <strong>gpa</strong>, mas que estudou em uma escola <em>ranking</em> 4:</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb158-1" data-line-number="1">pred=<span class="kw">data.frame</span>(<span class="dt">gre=</span><span class="dv">700</span>,</a>
<a class="sourceLine" id="cb158-2" data-line-number="2">                <span class="dt">gpa=</span><span class="fl">3.67</span>,</a>
<a class="sourceLine" id="cb158-3" data-line-number="3">                <span class="dt">rank=</span><span class="kw">factor</span>(<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb158-4" data-line-number="4">                )</a>
<a class="sourceLine" id="cb158-5" data-line-number="5">pred<span class="op">$</span>prob=<span class="kw">predict</span>(mylogit, <span class="dt">newdata=</span>pred, <span class="dt">type=</span><span class="st">&quot;response&quot;</span>)</a>
<a class="sourceLine" id="cb158-6" data-line-number="6">pred</a></code></pre></div>
<pre><code>  gre  gpa rank   prob
1 700 3.67    4 0.2679</code></pre>
<p>Agora será efetuada a predição comparando-se os <em>rankings</em> das escolas. No exemplo abaixo, é criada uma base de dados com as notas médias dos alunos nas variáveis <strong>gre</strong> e <strong>gpa</strong>, intercalando com todos os <em>rankings</em> das escolas onde estudaram. Após criar a tabela, esta é unida com as colunas de predição dos valores da equação. São renomeadas as variáveis de <em>fit</em> para <em>prob</em> e <em>se.fit</em> para <em>se.prob</em>, no primeiro caso pois obteiveram-se as probabilidades de cada caso e no segundo caso incluiu-se o erro padrão (<em>se: standart error</em>) desta probabilidade. Com este erro padrão calculou-se os limites inferior (<em>LL: low level</em>) e superior (<em>UL: upper level </em>) no intervalo de confiança de 95%.</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb160-1" data-line-number="1"><span class="co"># Criação da tabela</span></a>
<a class="sourceLine" id="cb160-2" data-line-number="2">novosdados=<span class="kw">with</span>(binary,</a>
<a class="sourceLine" id="cb160-3" data-line-number="3">                <span class="kw">data.frame</span>(<span class="dt">gre=</span><span class="kw">mean</span>(gre),</a>
<a class="sourceLine" id="cb160-4" data-line-number="4">                           <span class="dt">gpa=</span><span class="kw">mean</span>(gpa),</a>
<a class="sourceLine" id="cb160-5" data-line-number="5">                           <span class="dt">rank=</span><span class="kw">factor</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>)))</a>
<a class="sourceLine" id="cb160-6" data-line-number="6"></a>
<a class="sourceLine" id="cb160-7" data-line-number="7"><span class="co"># Incluindo a predição dos valores</span></a>
<a class="sourceLine" id="cb160-8" data-line-number="8">novosdados=<span class="kw">cbind</span>(novosdados,<span class="kw">predict</span>(mylogit, </a>
<a class="sourceLine" id="cb160-9" data-line-number="9">                                    <span class="dt">newdata=</span>novosdados,</a>
<a class="sourceLine" id="cb160-10" data-line-number="10">                                    <span class="dt">type=</span><span class="st">&quot;response&quot;</span>,</a>
<a class="sourceLine" id="cb160-11" data-line-number="11">                                    <span class="dt">se.fit=</span><span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb160-12" data-line-number="12"><span class="co"># Renomeando as variáveis</span></a>
<a class="sourceLine" id="cb160-13" data-line-number="13"><span class="kw">names</span>(novosdados)[<span class="kw">names</span>(novosdados)<span class="op">==</span><span class="st">&#39;fit&#39;</span>]=<span class="st">&quot;prob&quot;</span></a>
<a class="sourceLine" id="cb160-14" data-line-number="14"><span class="kw">names</span>(novosdados)[<span class="kw">names</span>(novosdados)<span class="op">==</span><span class="st">&#39;se.fit&#39;</span>]=<span class="st">&quot;se.prob&quot;</span></a>
<a class="sourceLine" id="cb160-15" data-line-number="15"></a>
<a class="sourceLine" id="cb160-16" data-line-number="16"><span class="co"># Estimando os intervalos de confiança</span></a>
<a class="sourceLine" id="cb160-17" data-line-number="17"></a>
<a class="sourceLine" id="cb160-18" data-line-number="18">novosdados<span class="op">$</span>LL=novosdados<span class="op">$</span>prob<span class="fl">-1.96</span><span class="op">*</span>novosdados<span class="op">$</span>se.prob</a>
<a class="sourceLine" id="cb160-19" data-line-number="19">novosdados<span class="op">$</span>UL=novosdados<span class="op">$</span>prob<span class="fl">+1.96</span><span class="op">*</span>novosdados<span class="op">$</span>se.prob</a>
<a class="sourceLine" id="cb160-20" data-line-number="20"></a>
<a class="sourceLine" id="cb160-21" data-line-number="21"><span class="co"># Vizualização dos dados</span></a>
<a class="sourceLine" id="cb160-22" data-line-number="22">novosdados</a></code></pre></div>
<pre><code>    gre  gpa rank   prob se.prob residual.scale      LL     UL
1 587.7 3.39    1 0.5166 0.06632              1 0.38662 0.6466
2 587.7 3.39    2 0.3523 0.03978              1 0.27431 0.4303
3 587.7 3.39    3 0.2186 0.03825              1 0.14364 0.2936
4 587.7 3.39    4 0.1847 0.04864              1 0.08934 0.2800</code></pre>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb162-1" data-line-number="1"><span class="kw">require</span>(ggplot2)</a>
<a class="sourceLine" id="cb162-2" data-line-number="2"><span class="kw">ggplot</span>(novosdados, <span class="kw">aes</span>(<span class="dt">x=</span>rank,<span class="dt">y=</span>prob))<span class="op">+</span></a>
<a class="sourceLine" id="cb162-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin=</span>LL, <span class="dt">ymax=</span>UL), <span class="dt">width=</span><span class="fl">0.2</span>,<span class="dt">lty=</span><span class="dv">1</span>,<span class="dt">lwd=</span><span class="dv">1</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb162-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">shape=</span><span class="dv">18</span>, <span class="dt">size=</span><span class="dv">5</span>, <span class="dt">fill=</span><span class="st">&quot;black&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb162-5" data-line-number="5"><span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">limits=</span><span class="kw">c</span>(<span class="st">&quot;1&quot;</span>,<span class="st">&quot;2&quot;</span>,<span class="st">&quot;3&quot;</span>,<span class="st">&quot;4&quot;</span>))<span class="op">+</span></a>
<a class="sourceLine" id="cb162-6" data-line-number="6"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Probabilidades preditas&quot;</span>, <span class="dt">x=</span><span class="st">&quot;Ranking&quot;</span>,<span class="dt">y=</span><span class="st">&quot;Pr(y=1)&quot;</span>)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-79-1.png" width="80%" style="display: block; margin: auto;" /></p>
<!--
\printbibliography[segment=\therefsegment,heading=subbibliography]
-->
<!--
## Exemplos de trabalhos que utilizaram regressão logística

- **Uso da regressão logística na estimação da probabilidade de reincidência de jovens infratoras**. <http://bdm.unb.br/bitstream/10483/13133/1/2015_FelipeGomesRibeiro.pdf>

- **Técnicas de Regressão Logística aplicada à Análise Ambiental**
<http://www.uel.br/revistas/uel/index.php/geografia/article/download/6878/9676>

- **Reincidência penal: uma análise a partir da e"conomia do crime" para subsidiar decisões judiciais.** <http://177.101.17.124/index.php/sociais/article/download/6029/4134>
-->
</div>
<div id="exercicios" class="section level2">
<h2><span class="header-section-number">5.5</span> Exercícios</h2>
<!--

reinc=sample(x = c(1, 0), size = 500, replace = TRUE)
raca=sample(x = c("branca", "outro"), size = 500, replace = TRUE)
idade=sample(x = 18:80, size = 500, replace = TRUE)
sexo=sample(x = c("M", "F"), size = 500, replace = TRUE)
crime=sample(x = c("transito", "drogas","roubo","outros"), size = 500, replace = TRUE)
temporeclusao=sample(x = 1:10, size = 500, replace = TRUE)
condicionalcrime=data.frame(reinc,raca,idade,sexo,crime,temporeclusao)
View(condicionalcrime)
summary(condicionalcrime)
glm(reinc~., data=condicionalcrime)
summary(glm(reinc~., data=condicionalcrime))
step(glm(reinc~., data=condicionalcrime),direction = 'both')
-->
<p><strong>1.</strong> O Titanic foi um famoso navio britânico construído a partir de março de 1909 e lançado ao mar em maio de 1911. Em sua viagem inaugural em 10 de abril de 1912, cujo objetivo era partir de Southampton para Nova Iorque passando pela França e Irlanda, colidiu com um iceberg às 23h40min do dia 14 de abril. Baixe os dados do acidente em
<a href="https://vincentarelbundock.github.io/Rdatasets/csv/COUNT/titanic.csv" class="uri">https://vincentarelbundock.github.io/Rdatasets/csv/COUNT/titanic.csv</a>. Esta base de dados possui as seguintes informações:</p>
<ul>
<li><strong>survived</strong>: informa se o tripulante sobreviveu ou não (“yes”, “no”);</li>
<li><strong>class</strong>: representa a classe em que viajavam os tripulantes (“1st class”, “2nd class” e “3rd class”).</li>
<li><strong>age</strong>: variável que separa entre as crianças (“child”) e adultos (“adults”)</li>
<li><strong>sex</strong>: fator com o sexo do tripulante (“women”, “man”)</li>
</ul>
<p><strong>1.1.</strong> Importe os dados para um objeto denominado <em>titanic</em> (lembre-se de determinar que as variávei sejam fatores).</p>
<p><strong>1.2</strong> Crie uma nova a variável <em>sobreviveu</em> a partir de <em>survived</em> com fatores binários 0 e 1 (1 para os sobreviventes).</p>
<p><strong>1.3</strong> Crie um modelo de regressão logística para descobrir a probabilidade de sobrevivência dos tripulantes (variável dependente <code>sobreviveu</code>) em relação às variáveis <code>class</code>, <code>age</code>, <code>sex</code>. Utilize o comando <code>summary</code> com o modelo. Declare a significância estatística das variáveis.</p>
<p><strong>1.4</strong> Com base na resposta anterior, disserte sobre a direção do sinal do <em>log</em> da probabilidade de sobrevivência com relação à cada variável independente do modelo. Quem estava na primeira classe tinha maiores chances de sobrevivência, ou na terceira? Adultos ou crianças tinham melhores chances de sobreviver, homens ou mulheres?</p>
<p><strong>1.5</strong> Transforme os coeficientes encontrados em Razão de Chances (OR - Odds Ratio), bem como verifique os intervalos de confiança.</p>
<p><strong>1.6</strong> Com base na resposta anterior, disserte sobre a razão das chances (OR) de cada variável independente do modelo.</p>
<p><strong>1.7</strong> Efetue a predição da probabilidade de sobrevivência de uma tripulante do sexo feminino, adulta e que viajava na primeira classe do navio.</p>
<p><strong>1.8</strong> Efetue a predição da probabilidade de sobrevivência de um tripulante do sexo masculino, adulto e que viajava na terceira classe do navio.</p>
<p><strong>1.9</strong> Crie a matriz de confusão e a Curva ROC para o modelo, avaliando seus dados.</p>
<p><strong>1.10</strong> Efetue o teste de Hosmer e Lemeschow para o modelo.</p>
<p><strong>1.11</strong> Encontre as medidas de pseudo R<span class="math inline">\(^2\)</span>.</p>
<p><strong>1.12</strong> Utilize o método <strong>Stepwise</strong> (<em>direction=‘both’</em>) no modelo completo e avalie se as variáveis devem permanecer no modelo ou alguma deve sair.</p>
</div>
</div>
<h3>Referências</h3>
<div id="refs" class="references">
<div id="ref-Torres-Reyna2014">
<p>Torres-Reyna, Oscar. 2014. «Logit, Probit and Multinomial Logit models in R». <a href="http://dss.princeton.edu/training/LogitR101.pdf" class="uri">http://dss.princeton.edu/training/LogitR101.pdf</a>.</p>
</div>
<div id="ref-Hair2009">
<p>Hair, Joseph F., William C. Black, Barry J. Babin, e Ronald L. Tatham. 2009. <em>Análise Multivariada de Dados</em>. 6a ed. São Paulo: Bookman.</p>
</div>
<div id="ref-Hosmer2000">
<p>Hosmer, David W., e Stanley Lemeschow. 2000. <em>Applied Logistic Regression</em>. 2a ed. New York: Wiley.</p>
</div>
<div id="ref-Fawcett2006">
<p>Fawcett, Tom. 2006. «An introduction to ROC analysis». <em>Pattern Recognition Letters</em> 27:861–74.</p>
</div>
<div id="ref-Rawlings1998">
<p>Rawlings, John O, Sastry G Pantula, e David A. Dickey. 1998. <em>Applied Regression Analysis: A Research Tool</em>. New York: Springer.</p>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>Para mais exemplos como estes sobre análises preditivas, ver <span class="citation">Siegel (<a href="#ref-Siegel2017">2017</a>)</span>.<a href="regressao-logistica.html#fnref1" class="footnote-back">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="regressao-com-dados-em-painel.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="regressao-de-poisson.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"download": ["livroavancado.pdf"],
"toc": {
"collapse": "subsection"
},
"search": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
